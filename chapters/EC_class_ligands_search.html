
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Enzyme Commission Class with Ligands &#8212; Python Data and Scripting for Biochemists and Molecular Biologists</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=0905f21a" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-FHKVGE8HKZ"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-FHKVGE8HKZ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-FHKVGE8HKZ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/EC_class_ligands_search';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.11/dist/embed-amd.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visualizing the Binding Site of a Protein-Ligand Complex" href="binding_site_investigation.html" />
    <link rel="prev" title="Molecular Visualization with iCN3D" href="MolVis_with_iCN3D.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="setup.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/molssi_main_logo.png" class="logo__image only-light" alt="Python Data and Scripting for Biochemists and Molecular Biologists - Home"/>
    <script>document.write(`<img src="../_static/molssi_main_logo_inverted_white.png" class="logo__image only-dark" alt="Python Data and Scripting for Biochemists and Molecular Biologists - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="workshop_schedule.html">Workshop Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="File_Parsing.html">File Parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Processing_Multiple_Files_and_Writing_Files.html">Processing Multiple Files and Writing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Working_with_Pandas.html">Working with Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Linear_Regression.html">Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="Creating_Plots_in_Jupyter_Notebooks.html">Creating Plots in Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinear_regression_part_1.html">Nonlinear Regression Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinear_regression_part_2.html">Nonlinear Regression Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="biopython_mmcif.html">Analyzing MMCIF Files using Biopython</a></li>
<li class="toctree-l1"><a class="reference internal" href="rcsb_api.html">Retrieving Information from the PDB using the Web API</a></li>
<li class="toctree-l1"><a class="reference internal" href="MolVis_with_iCN3D.html">Molecular Visualization with iCN3D</a></li>



<li class="toctree-l1 current active"><a class="current reference internal" href="#">Enzyme Commission Class with Ligands</a></li>
<li class="toctree-l1"><a class="reference internal" href="binding_site_investigation.html">Visualizing the Binding Site of a Protein-Ligand Complex</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/EC_class_ligands_search.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Enzyme Commission Class with Ligands</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-7-enzyme-classes">The 7 Enzyme Classes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#libraries-for-the-iqb-workshop">Libraries for the IQB workshop</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#making-queries">Making queries</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-ligands">Finding the ligands</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#where-can-we-go-to-download-the-ligand-files">Where can we go to download the ligand files?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-do-we-download-the-ligand-files">How do we download the ligand files?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-all-of-the-ligands-using-a-for-loop">Downloading all of the ligands using a for loop</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selected-ligands">Selected ligands</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="enzyme-commission-class-with-ligands">
<h1>Enzyme Commission Class with Ligands<a class="headerlink" href="#enzyme-commission-class-with-ligands" title="Link to this heading">#</a></h1>
<div class="overview admonition">
<p class="admonition-title">Overview</p>
<p>Questions</p>
<ul class="simple">
<li><p>How are enzymes classified?</p></li>
<li><p>How can I search the PDB for ligands that bind to a specific enzyme class?</p></li>
</ul>
<p>Objectives</p>
<ul class="simple">
<li><p>Understand the hierarchical classification of enzymes using the Enzyme Commission (EC) system.</p></li>
<li><p>Use the RCSB Search API to find ligands that bind to a specific enzyme class.</p></li>
</ul>
</div>
<p>Enzymes are biological catalysts and most enzymes are proteins (at least that’s our current thinking).
To systematize the study of enzymes, IUPAC (the International Union of Pure and Applied Chemistry) has organized enzymes in a hierarchical class structure, with 7 top level classes and a total of 4 levels in the hierarchy.</p>
<p>These classes are called the Enzyme Commission (EC) classes, and the hierarchy is called the EC system.
Each enzyme is assigned an EC number based on the type of reaction it catalyzes.
In this notebook, we will use the RCSB Search API to find ligands that bind to a specific enzyme class.</p>
<section id="the-7-enzyme-classes">
<h2>The 7 Enzyme Classes<a class="headerlink" href="#the-7-enzyme-classes" title="Link to this heading">#</a></h2>
<p>The <a class="reference external" href="https://www.brenda-enzymes.org/">BRENDA Enzyme Database</a> contains detailed information about enzymes and includes a <a class="reference external" href="https://www.brenda-enzymes.org/ecexplorer.php?browser=1">browser tree for enzyme classes</a>. The 7 major classes of enzymes on the top level of the tree are</p>
<ol class="arabic simple">
<li><p>Oxidoreductases</p></li>
<li><p>Transferases</p></li>
<li><p>Hydrolases</p></li>
<li><p>Lyases</p></li>
<li><p>Isomerases</p></li>
<li><p>Ligases</p></li>
<li><p>Translocases</p></li>
</ol>
<p>On the <a class="reference external" href="https://www.brenda-enzymes.org/index.php">BRENDA Home Page</a>, you can search for an enzyme by name and find its Enzyme Commision (EC) number, and a lot more detail as well.
The first image below is the search for the enzyme HMG CoA Reductase, the control point for cholesterol synthesis.
The second image shows the initial results page, which includes the EC number.</p>
<p><img alt="The BRENDA Home Page" src="../_images/BRENDA_Home_Page_search_for_HMG-CoA_Reductase.png" /></p>
<p><img alt="BRENDA Search Results" src="../_images/BRENDA_HMG-CoA_Reductase_search.png" /></p>
<p>In this notebook, we will focus on trypsin, an enzyme produced by your pancreas that helps to digest proteins in your small intestine. It is a member of family called serine hydrolases. Members of this family use water to break bonds in proteins, lipids and carbohydrates. They are involved in digestion, cell signalling and blood clotting. The EC# for trypsin is 3.4.21.4. Here is the meaning of each level of the hierarchy:</p>
<ul class="simple">
<li><p>3 - Hydrolase</p></li>
<li><p>3.4 - acting on peptide bonds</p></li>
<li><p>3.4.21 - serine endopeptidase</p></li>
<li><p>3.4.21.4 - trypsin</p></li>
</ul>
<p>This notebook is intended to help users find ligands for use with docking studies.
We are looking for ligands that will bind to trypsin, with the intention of seeing if they will bind to other serine hydrolases that might be interesting. Here are the steps we will follow in the process, all of which will employ the <code class="docutils literal notranslate"><span class="pre">rcsbsearchapi</span></code> package.</p>
<ol class="arabic simple">
<li><p>Find PDB structures of a given Enzyme Commission class.</p></li>
<li><p>Select those structures that contain bound small molecules with molecular weights between 300 and 600.</p></li>
<li><p>Output a list of those ligands</p></li>
<li><p>Save the ligand structures to the “ligands_for_EC_class_#” folder.</p></li>
</ol>
<p>Text (actually markdown) cells will be inserted to explain each step.</p>
<section id="libraries-for-the-iqb-workshop">
<h3>Libraries for the IQB workshop<a class="headerlink" href="#libraries-for-the-iqb-workshop" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Library</p></th>
<th class="head text-center"><p>abbreviation</p></th>
<th class="head text-left"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>rcsbsearchapi</p></td>
<td class="text-center"><p>N/A</p></td>
<td class="text-left"><p>functions for searching the Protein Data Bank based on the mmCIF dictionary</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>os</p></td>
<td class="text-center"><p>N/A</p></td>
<td class="text-left"><p>operating system functions - handling file paths and directories.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>requests</p></td>
<td class="text-center"><p>N/A</p></td>
<td class="text-left"><p>access APIs for databases</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>rdkit</p></td>
<td class="text-center"><p>rdkit</p></td>
<td class="text-left"><p>an open source github repository of cheminformatics software</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>rdkit.Chem</p></td>
<td class="text-center"><p>Chem</p></td>
<td class="text-left"><p>a subset of rdkit that supports file string to structure conversions</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>rdkit.Chem.AllChem</p></td>
<td class="text-center"><p>AllChem</p></td>
<td class="text-left"><p>a subset of rdkit.Chem that supports energy optimization</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>rdkit.Chem.Draw</p></td>
<td class="text-center"><p>Draw</p></td>
<td class="text-left"><p>a subset of rdkit that supports chemical drawing in Python</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>vina</p></td>
<td class="text-center"><p>vina</p></td>
<td class="text-left"><p>AutoDock Vina software for Python and Jupyter notebooks</p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the components of rcsbsearchapi needed for this search</span>
<span class="kn">from</span> <span class="nn">rcsbsearchapi</span> <span class="kn">import</span> <span class="n">rcsb_attributes</span> <span class="k">as</span> <span class="n">attrs</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="making-queries">
<h2>Making queries<a class="headerlink" href="#making-queries" title="Link to this heading">#</a></h2>
<p>To make a query with <code class="docutils literal notranslate"><span class="pre">rcsbsearchapi</span></code> you first must know what you are looking for. I find it helpful to actually write this out by hand sometimes. Here are the characteristics I am looking for in ligands that bind to a specific Enzyme Commission Class of a protein.</p>
<ul class="simple">
<li><p>EC Class. I will focus on the EC class for trypsin, 3.4.21.4, but any class should work.</p></li>
<li><p>Ligands. I am looking for ligands that are larger than a single atom (e.g., potassium ion) or a buffer molecule (phosphate), but of a size that consists of 10-30 heavy atoms, so I will aim for a molecular weight between 300 and 800.</p></li>
</ul>
<p>Please note that you can use this interface to search for dozens of attributes associated with a PDB entry. The attribute that we will use to look for proteins that have the EC# = 3.4.21.4 is <code class="docutils literal notranslate"><span class="pre">rcsb_polymer_entity.rcsb_ec_lineage.id</span></code>. Other searchable attributes include the abbreviated journal title for the primary citation, <code class="docutils literal notranslate"><span class="pre">rcsb_primary_citation.rcsb_journal_abbrev</span></code>, the method used to determine the structure <code class="docutils literal notranslate"><span class="pre">exptl.method</span></code>, or specific molecules that are part of PDB entries `pdbx_reference_molecule.class’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># There will be three components to the query, which will be labeled q1, q2 and q3.</span>

<span class="n">ECnumber</span> <span class="o">=</span> <span class="s2">&quot;3.4.21.4&quot;</span>     <span class="c1"># We will use this variable again later</span>

<span class="n">q1</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">rcsb_polymer_entity</span><span class="o">.</span><span class="n">rcsb_ec_lineage</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">ECnumber</span>  <span class="c1"># looking for trypsins</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">chem_comp</span><span class="o">.</span><span class="n">formula_weight</span> <span class="o">&gt;=</span> <span class="mi">300</span>                       <span class="c1"># setting the lower limit for molecular weight</span>
<span class="n">q3</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">chem_comp</span><span class="o">.</span><span class="n">formula_weight</span> <span class="o">&lt;=</span> <span class="mi">800</span>                       <span class="c1"># setting the upper limit for molecular weight</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">&amp;</span> <span class="n">q2</span> <span class="o">&amp;</span> <span class="n">q3</span>              <span class="c1"># combining the three queries into one</span>

<span class="n">resultL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">query</span><span class="p">())</span>           <span class="c1"># assign the results of the query to a list variable</span>

<span class="nb">print</span><span class="p">(</span><span class="n">resultL</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>              <span class="c1"># list the first 10 results</span>

<span class="nb">len</span><span class="p">(</span><span class="n">resultL</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;1AQ7&#39;, &#39;1AUJ&#39;, &#39;1AZ8&#39;, &#39;1BJV&#39;, &#39;1BTW&#39;, &#39;1BTX&#39;, &#39;1BTZ&#39;, &#39;1C1S&#39;, &#39;1C1T&#39;, &#39;1C2D&#39;]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>180
</pre></div>
</div>
</div>
</div>
<section id="finding-the-ligands">
<h3>Finding the ligands<a class="headerlink" href="#finding-the-ligands" title="Link to this heading">#</a></h3>
<p>This query provided the list of the PDB entries for trypsins (EC # 3.4.21.4) that contain ligands between 300 and 800 molecular weight.
We printed the first 10 of these results using <code class="docutils literal notranslate"><span class="pre">print(resultL[0:10])</span></code>.</p>
<p>Why would we choose to have ligands with molecular weights between 300 and 800? We are interested in molecules that are large enough to bind to and fill up the active site of trypsin. Small molecules with molecular weights less than 300 are likely to be individual ions (K<sup>+</sup> or Na<sup>+</sup>). Molecules with molecular weights greater than 800 will fill more than the active site of an enzyme.</p>
<p>Here is an image of one of the ligands from the search that we’re going to learn to download. It is identified in the Protein Data Bank as 13U. As a group we will look at some of the features that make this ligand interesting.</p>
<p><img alt="PDB Entry 13U" src="../_images/13U.svg" /></p>
<p>The last statement in the previous cell</p>
<p><code class="docutils literal notranslate"><span class="pre">len(resultL)</span></code></p>
<p>tells us how many PDB entries have ligands of that size. The default return item for the query is <code class="docutils literal notranslate"><span class="pre">structure</span></code>, which provides the four character alphanumeric entry for the full structure in the PDB. We want to identify and download the ligands that are bound to these PDB structures, so we need to switch return types.</p>
<p>To get the ligand, instead of returning the <code class="docutils literal notranslate"><span class="pre">structure</span></code>, we will request a return type of <code class="docutils literal notranslate"><span class="pre">mol_definition</span></code> which will then return the three character alphanumeric entry for the ligand. Other possible return types are <code class="docutils literal notranslate"><span class="pre">polymer</span> <span class="pre">entities</span></code>, <code class="docutils literal notranslate"><span class="pre">assemblies</span></code>, and <code class="docutils literal notranslate"><span class="pre">non-polymer</span> <span class="pre">entities</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molResultL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;mol_definition&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">molResultL</span><span class="p">),</span> <span class="s2">&quot;ligands for EC Number&quot;</span><span class="p">,</span> <span class="n">ECnumber</span><span class="p">,</span> <span class="s2">&quot;in this list. Here is a list of the first 10 ligands.&quot;</span><span class="p">)</span>
<span class="n">molResultL</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are 112 ligands for EC Number 3.4.21.4 in this list. Here is a list of the first 10 ligands.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;0CA&#39;, &#39;0CB&#39;, &#39;0KV&#39;, &#39;0ZG&#39;, &#39;0ZW&#39;, &#39;0ZX&#39;, &#39;0ZY&#39;, &#39;10U&#39;, &#39;11U&#39;, &#39;12U&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="where-can-we-go-to-download-the-ligand-files">
<h3>Where can we go to download the ligand files?<a class="headerlink" href="#where-can-we-go-to-download-the-ligand-files" title="Link to this heading">#</a></h3>
<p>To download the files for ligands bound to trypsin in the RCSB PDB, execute the two cells above for finding the trypsin ligands. This will reset the results to the ones we want.</p>
<p>Once this is done, the next step is to determine exactly what we want to download. These ligand files in the PDB are avaiable for download in several formats. A full list and description can be found in the <a class="reference external" href="https://www.rcsb.org/docs/programmatic-access/file-download-services#small-molecule-files">Small Molecule File table</a> on the <a class="reference external" href="https://www.rcsb.org/docs/programmatic-access/file-download-services">RCSB PDB File Download Services page</a>, which is pasted in here.</p>
<p><img alt="Small molecule file formats that can be downloaded from the RCSB PDB" src="../_images/SmallMoleculeFilesTable.png" /></p>
<p>From this table, we want the ligand files in mol2 format, which we will later convert to another format called <code class="docutils literal notranslate"><span class="pre">pdbqt</span></code> for docking.</p>
</section>
<section id="how-do-we-download-the-ligand-files">
<h3>How do we download the ligand files?<a class="headerlink" href="#how-do-we-download-the-ligand-files" title="Link to this heading">#</a></h3>
<p>There are several options for downloading files - we will use a Python libary called <code class="docutils literal notranslate"><span class="pre">requests</span></code>. In the following cells, we will import the library, <code class="docutils literal notranslate"><span class="pre">requests</span></code>, download a single file from the RCSB PDB using the <code class="docutils literal notranslate"><span class="pre">requests.get</span></code> function, and check to make sure the file downloaded properly to the ligands folder. If that is successful, we’ll use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to download all of the files from our <code class="docutils literal notranslate"><span class="pre">molResultL</span></code> list to the ligands folder.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>  <span class="c1"># to enable us to pull files from the PDB</span>
<span class="kn">import</span> <span class="nn">os</span>        <span class="c1"># to enable us to create a directory to store the files</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download one of the files from our list: 11U.mol2</span>

<span class="n">res11U_mol2</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://files.rcsb.org/ligands/download/11U_ideal.mol2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check to see that the file downloaded properly. A status code of 200 means everything is okay.</span>

<span class="n">res11U_mol2</span><span class="o">.</span><span class="n">status_code</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>200
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To really be sure, let&#39;s look at the file one line at a time. First we write the downloaded content to a file.</span>

<span class="c1"># make a ligands folder for our results</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;ligands&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;ligands/res11U.mol2&quot;</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">res11U_mol2</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now we use these commands to read the file and make sure it downloaded properly. As an alternative, we</span>
<span class="c1"># could go to the ligands folder in our Jupyter desktop and click on res11U.mol2 to make sure it looks correct.</span>

<span class="n">file1</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;ligands/res11U.mol2&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">file_text</span> <span class="o">=</span> <span class="n">file1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># This reads in the file as a string.</span>

<span class="nb">print</span><span class="p">(</span><span class="n">file_text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>@&lt;TRIPOS&gt;MOLECULE
11U
   59    61     0     0     0
SMALL
NO_CHARGES

@&lt;TRIPOS&gt;ATOM
      1 C1          2.4220    0.4070    0.3360 C.2       1 11U_ideal         0.0000
      2 O1          2.0060   -0.6420    0.7800 O.2       1 11U_ideal         0.0000
      3 C2          3.8690    0.5350   -0.0630 C.3       1 11U_ideal         0.0000
      4 N1          4.5590   -0.7380    0.1810 N.3       1 11U_ideal         0.0000
      5 C3          5.9760   -0.6510   -0.1970 C.3       1 11U_ideal         0.0000
      6 C4          6.7790   -0.0680    0.9670 C.3       1 11U_ideal         0.0000
      7 C5          8.2550    0.0240    0.5730 C.3       1 11U_ideal         0.0000
      8 C6          8.7810   -1.3740    0.2400 C.3       1 11U_ideal         0.0000
      9 C7          7.9780   -1.9570   -0.9250 C.3       1 11U_ideal         0.0000
     10 C8          6.5020   -2.0480   -0.5310 C.3       1 11U_ideal         0.0000
     11 N2          1.5890    1.4580    0.1990 N.am      1 11U_ideal         0.0000
     12 C9          0.1600    1.4690    0.5420 C.3       1 11U_ideal         0.0000
     13 C10        -0.5770    0.4580   -0.2980 C.2       1 11U_ideal         0.0000
     14 O2          0.0270   -0.2120   -1.1080 O.2       1 11U_ideal         0.0000
     15 C11        -0.3710    2.8880    0.2460 C.3       1 11U_ideal         0.0000
     16 C12         0.9140    3.7560    0.2780 C.3       1 11U_ideal         0.0000
     17 C13         1.9600    2.7850   -0.3250 C.3       1 11U_ideal         0.0000
     18 N3         -1.9070    0.2990   -0.1490 N.am      1 11U_ideal         0.0000
     19 C14        -2.6230   -0.6850   -0.9660 C.3       1 11U_ideal         0.0000
     20 C15        -4.0860   -0.6660   -0.6070 C.ar      1 11U_ideal         0.0000
     21 C16        -4.5620   -1.4980    0.3910 C.ar      1 11U_ideal         0.0000
     22 C17        -5.9000   -1.4810    0.7270 C.ar      1 11U_ideal         0.0000
     23 C18        -6.7750   -0.6300    0.0520 C.ar      1 11U_ideal         0.0000
     24 C19        -8.2130   -0.6110    0.4050 C.2       1 11U_ideal         0.0000
     25 N4         -9.0280    0.1840   -0.2270 N.2       1 11U_ideal         0.0000
     26 N5         -8.6890   -1.4350    1.4020 N.pl3     1 11U_ideal         0.0000
     27 C20        -6.2910    0.2030   -0.9560 C.ar      1 11U_ideal         0.0000
     28 C21        -4.9490    0.1800   -1.2800 C.ar      1 11U_ideal         0.0000
     29 H1          3.9330    0.7860   -1.1220 H         1 11U_ideal         0.0000
     30 H2          4.3400    1.3220    0.5260 H         1 11U_ideal         0.0000
     31 H3          4.4590   -1.0250    1.1430 H         1 11U_ideal         0.0000
     32 H4          6.0800   -0.0050   -1.0690 H         1 11U_ideal         0.0000
     33 H5          6.4040    0.9280    1.2050 H         1 11U_ideal         0.0000
     34 H6          6.6750   -0.7130    1.8390 H         1 11U_ideal         0.0000
     35 H7          8.8270    0.4390    1.4030 H         1 11U_ideal         0.0000
     36 H8          8.3590    0.6690   -0.2990 H         1 11U_ideal         0.0000
     37 H9          8.6770   -2.0190    1.1120 H         1 11U_ideal         0.0000
     38 H10         9.8320   -1.3090   -0.0410 H         1 11U_ideal         0.0000
     39 H11         8.3530   -2.9520   -1.1620 H         1 11U_ideal         0.0000
     40 H12         8.0820   -1.3110   -1.7970 H         1 11U_ideal         0.0000
     41 H13         6.3980   -2.6930    0.3420 H         1 11U_ideal         0.0000
     42 H14         5.9300   -2.4630   -1.3600 H         1 11U_ideal         0.0000
     43 H15         0.0300    1.2400    1.6000 H         1 11U_ideal         0.0000
     44 H16        -1.0720    3.2080    1.0170 H         1 11U_ideal         0.0000
     45 H17        -0.8360    2.9240   -0.7390 H         1 11U_ideal         0.0000
     46 H18         1.1770    4.0280    1.3010 H         1 11U_ideal         0.0000
     47 H19         0.8020    4.6440   -0.3440 H         1 11U_ideal         0.0000
     48 H20         2.9630    3.0560    0.0040 H         1 11U_ideal         0.0000
     49 H21         1.9020    2.7930   -1.4130 H         1 11U_ideal         0.0000
     50 H22        -2.3900    0.8350    0.4990 H         1 11U_ideal         0.0000
     51 H23        -2.5040   -0.4370   -2.0200 H         1 11U_ideal         0.0000
     52 H24        -2.2160   -1.6780   -0.7780 H         1 11U_ideal         0.0000
     53 H25        -3.8840   -2.1590    0.9100 H         1 11U_ideal         0.0000
     54 H26        -6.2690   -2.1270    1.5090 H         1 11U_ideal         0.0000
     55 H27        -9.9700    0.1960    0.0040 H         1 11U_ideal         0.0000
     56 H28        -8.0820   -2.0270    1.8720 H         1 11U_ideal         0.0000
     57 H29        -9.6310   -1.4220    1.6330 H         1 11U_ideal         0.0000
     58 H30        -6.9630    0.8640   -1.4820 H         1 11U_ideal         0.0000
     59 H31        -4.5730    0.8240   -2.0610 H         1 11U_ideal         0.0000
@&lt;TRIPOS&gt;BOND
     1    1   11 am
     2   11   17 1
     3   11   12 1
     4    1    2 2
     5    1    3 1
     6   16   17 1
     7   15   16 1
     8   12   15 1
     9   12   13 1
    10   13   18 am
    11   13   14 2
    12   18   19 1
    13   19   20 1
    14   20   28 ar
    15   20   21 ar
    16   27   28 ar
    17   23   27 ar
    18   23   24 1
    19   22   23 ar
    20   24   25 2
    21   24   26 1
    22   21   22 ar
    23    3    4 1
    24    4    5 1
    25    5   10 1
    26    5    6 1
    27    9   10 1
    28    8    9 1
    29    7    8 1
    30    6    7 1
    31    3   29 1
    32    3   30 1
    33   17   48 1
    34   17   49 1
    35   16   46 1
    36   16   47 1
    37   15   44 1
    38   15   45 1
    39   12   43 1
    40   18   50 1
    41   19   51 1
    42   19   52 1
    43   28   59 1
    44   27   58 1
    45   25   55 1
    46   26   56 1
    47   26   57 1
    48   22   54 1
    49   21   53 1
    50    4   31 1
    51    5   32 1
    52   10   41 1
    53   10   42 1
    54    9   39 1
    55    9   40 1
    56    8   37 1
    57    8   38 1
    58    7   35 1
    59    7   36 1
    60    6   33 1
    61    6   34 1
</pre></div>
</div>
</div>
</div>
</section>
<section id="downloading-all-of-the-ligands-using-a-for-loop">
<h3>Downloading all of the ligands using a for loop<a class="headerlink" href="#downloading-all-of-the-ligands-using-a-for-loop" title="Link to this heading">#</a></h3>
<p>Now that we know that our process functions, we will use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to download the entire list of ligands (all 112) in a single cell. Here are the steps we will take:</p>
<ol class="arabic simple">
<li><p>Define a variable, baseUrl, for the URL where the ligand files are located. The URL only lacks the specific name of the ligand file.</p></li>
<li><p>Set up a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to go through each of the items (as ChemID) in the molResultL list that was generated above.</p></li>
<li><p>Assign the filename based on a variable (the 3-letter name of the ligand as ChemID followed by _ideal.mol2) to the variable cFile.</p></li>
<li><p>Assign the full URL (as cFileUrl) that we want to use to download the data from the RCSB PDB API. Notice that the URL will consist of the baseUrl (defined in the first line of the cell) followed by the name of the file we just defined, which is now assigned to the variable, cFile.</p></li>
<li><p>Tell the notebook that we want the file (CFileLocal) to be written to the ligands folder, using the os.path command.</p></li>
<li><p>Use the API call via <code class="docutils literal notranslate"><span class="pre">requests.get</span></code> to download the data from the RCSB PDB.</p></li>
<li><p>Write the file using the <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">open</span></code> function.</p></li>
</ol>
<p>If all goes according to plan, this should download all of the ligands on our list to the ligands folder.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">baseUrl</span> <span class="o">=</span> <span class="s2">&quot;https://files.rcsb.org/ligands/download/&quot;</span>

<span class="k">for</span> <span class="n">ChemID</span> <span class="ow">in</span> <span class="n">molResultL</span><span class="p">:</span>
    <span class="n">cFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ChemID</span><span class="si">}</span><span class="s2">_ideal.mol2&quot;</span>
    <span class="n">cFileUrl</span> <span class="o">=</span> <span class="n">baseUrl</span> <span class="o">+</span> <span class="n">cFile</span>
    <span class="n">cFileLocal</span> <span class="o">=</span> <span class="s2">&quot;ligands/&quot;</span> <span class="o">+</span> <span class="n">cFile</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cFileUrl</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">cFileLocal</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="selected-ligands">
<h3>Selected ligands<a class="headerlink" href="#selected-ligands" title="Link to this heading">#</a></h3>
<p>For our next notebook, we are going to select and modify one of the ligands from the list. Any of them could be used, but we will be using <a class="reference external" href="https://www.rcsb.org/ligand/13U">13U: N-cyclooctylglycyl-N-(4-carbamimidoylbenzyl)-L-prolinamide</a>.</p>
</section>
<section id="exercise">
<h3>Exercise<a class="headerlink" href="#exercise" title="Link to this heading">#</a></h3>
<p>To go a bit deeper with these tools, use the <a class="reference external" href="https://www.brenda-enzymes.org/">BRENDA Enzyme Database</a> to find the EC# for alcohol dehydrogenase (or look for an enzyme that interests you). How many structures have ligands with molecular weights between 400 and 700? How many unique ligands are bound to these structures?</p>
<p>Note: You can enter only the upper levels of an EC Class to identify more ligands. This exercise can be repeated with any EC#. If you have time, try a broader search where you use only 2 or 3 levels, e.g., 3.4 or 3.4.21, and see what you find.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution</span>

<span class="n">ECnumber</span> <span class="o">=</span> <span class="s2">&quot;1.1.1.1&quot;</span>     <span class="c1"># We will use this variable again later</span>

<span class="n">q1</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">rcsb_polymer_entity</span><span class="o">.</span><span class="n">rcsb_ec_lineage</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">ECnumber</span>  <span class="c1"># looking for trypsins</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">chem_comp</span><span class="o">.</span><span class="n">formula_weight</span> <span class="o">&gt;=</span> <span class="mi">400</span>                      <span class="c1"># setting the lower limit for molecular weight</span>
<span class="n">q3</span> <span class="o">=</span> <span class="n">attrs</span><span class="o">.</span><span class="n">chem_comp</span><span class="o">.</span><span class="n">formula_weight</span> <span class="o">&lt;=</span> <span class="mi">700</span>                     <span class="c1"># setting the upper limit for molecular weight</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">&amp;</span> <span class="n">q2</span> <span class="o">&amp;</span> <span class="n">q3</span>              <span class="c1"># combining the three queries into one</span>

<span class="n">ResultL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;entry&quot;</span><span class="p">))</span>
<span class="n">molResultL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;mol_definition&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ResultL</span><span class="p">),</span> <span class="s2">&quot;structures from EC Number&quot;</span><span class="p">,</span> <span class="n">ECnumber</span><span class="p">,</span> <span class="s2">&quot;that have bound ligands with molecular weights between 400 and 700).&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">molResultL</span><span class="p">),</span> <span class="s2">&quot;unique ligands for structures with EC Number&quot;</span><span class="p">,</span> <span class="n">ECnumber</span><span class="p">,</span> <span class="s2">&quot;in this list. Here is a list of the&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">molResultL</span><span class="p">),</span> <span class="s2">&quot;ligands.&quot;</span><span class="p">)</span>
<span class="n">molResultL</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are 173 structures from EC Number 1.1.1.1 that have bound ligands with molecular weights between 400 and 700).
There are 11 unique ligands for structures with EC Number 1.1.1.1 in this list. Here is a list of the 11 ligands.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;022&#39;, &#39;APR&#39;, &#39;CHD&#39;, &#39;CND&#39;, &#39;COD&#39;, &#39;NAD&#39;, &#39;NAI&#39;, &#39;NAJ&#39;, &#39;PAD&#39;, &#39;TAD&#39;, &#39;WKZ&#39;]
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="MolVis_with_iCN3D.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Molecular Visualization with iCN3D</p>
      </div>
    </a>
    <a class="right-next"
       href="binding_site_investigation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Visualizing the Binding Site of a Protein-Ligand Complex</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-7-enzyme-classes">The 7 Enzyme Classes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#libraries-for-the-iqb-workshop">Libraries for the IQB workshop</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#making-queries">Making queries</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-ligands">Finding the ligands</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#where-can-we-go-to-download-the-ligand-files">Where can we go to download the ligand files?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-do-we-download-the-ligand-files">How do we download the ligand files?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-all-of-the-ligands-using-a-for-loop">Downloading all of the ligands using a for loop</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selected-ligands">Selected ligands</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Molecular Sciences Software Institute
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>