
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>File Parsing &#8212; Python Data and Scripting for Biochemists and Molecular Biologists</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=0905f21a" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-FHKVGE8HKZ"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-FHKVGE8HKZ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-FHKVGE8HKZ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/File_Parsing';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Processing Multiple Files and Writing Files" href="Processing_Multiple_Files_and_Writing_Files.html" />
    <link rel="prev" title="Introduction" href="introduction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="setup.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/molssi_main_logo.png" class="logo__image only-light" alt="Python Data and Scripting for Biochemists and Molecular Biologists - Home"/>
    <script>document.write(`<img src="../_static/molssi_main_logo_inverted_white.png" class="logo__image only-dark" alt="Python Data and Scripting for Biochemists and Molecular Biologists - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="workshop_schedule.html">Workshop Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">File Parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Processing_Multiple_Files_and_Writing_Files.html">Processing Multiple Files and Writing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Working_with_Pandas.html">Working with Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Linear_Regression.html">Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="Creating_Plots_in_Jupyter_Notebooks.html">Creating Plots in Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinear_regression_part_1.html">Nonlinear Regression Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinear_regression_part_2.html">Nonlinear Regression Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="biopython_mmcif.html">Analyzing MMCIF Files using Biopython</a></li>
<li class="toctree-l1"><a class="reference internal" href="rcsb_api.html">Retrieving Information from the PDB using the Web API</a></li>
<li class="toctree-l1"><a class="reference internal" href="MolVis_with_iCN3D.html">Molecular Visualization with iCN3D</a></li>



<li class="toctree-l1"><a class="reference internal" href="EC_class_ligands_search.html">Enzyme Commission Class with Ligands</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/File_Parsing.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>File Parsing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-files">Working with files</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-file-paths-the-os-path-module">Working with file paths - the <code class="docutils literal notranslate"><span class="pre">os.path</span></code> module</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#absolute-and-relative-paths">Absolute and relative paths</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-a-file">Reading a file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#readlines-function-behavior"><code class="docutils literal notranslate"><span class="pre">readlines</span></code> function behavior</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-a-pattern-in-your-file">Searching for a pattern in your file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-a-particular-line-number-in-your-file">Searching for a particular line number in your file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-final-note-about-regular-expressions">A final note about regular expressions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="file-parsing">
<h1>File Parsing<a class="headerlink" href="#file-parsing" title="Link to this heading">#</a></h1>
<div class="overview admonition">
<p class="admonition-title">Overview</p>
<p>Questions:</p>
<ul class="simple">
<li><p>How do I sort through all the information in a text file and extract particular pieces of information?</p></li>
</ul>
<p>Objectives:</p>
<ul class="simple">
<li><p>Open a file and read in its contents line by line.</p></li>
<li><p>Search for a particular string in a file.</p></li>
<li><p>Manipulate strings and change data types.</p></li>
<li><p>Print to a new file.</p></li>
</ul>
</div>
<section id="working-with-files">
<h2>Working with files<a class="headerlink" href="#working-with-files" title="Link to this heading">#</a></h2>
<p>One of the most common tasks in research is analyzing data.  An enormous amount of data is currently being generated in biochemistry and molecular biology, much of it pertaining to sequence and structure. The PDB file format is commonly used to describe macromolecular structures that have been determined by experimental methods. You may be interested in exploring the text and/or the data in a PDB file.  While the <a class="reference external" href="https://www.rcsb.org/">PDB web site</a> is very helpful, there are times when it would be handy to extract specific information about one protein (or 1,000) with a few keystrokes. For example, you might be interested in the resolution of a structure, or the small molecules that are bound to the macromolecule.  In general, this is called file parsing.</p>
<section id="working-with-file-paths-the-os-path-module">
<h3>Working with file paths - the <code class="docutils literal notranslate"><span class="pre">os.path</span></code> module<a class="headerlink" href="#working-with-file-paths-the-os-path-module" title="Link to this heading">#</a></h3>
<p>For this section, we will be working with the file <code class="docutils literal notranslate"><span class="pre">4eyr</span></code> in the <code class="docutils literal notranslate"><span class="pre">PDB_files</span></code> directory.</p>
<p>Jupyter notebooks are designed to work in all operating systems. You may know that the operating system commands for organizing and working with files are different in Windows, Mac OS and Linux. To address this, we will use the Python <code class="docutils literal notranslate"><span class="pre">os</span></code> library. To use this library, we will first import it. Then we’ll start with two commands from the library, <code class="docutils literal notranslate"><span class="pre">getcwd()</span></code> which stands for <em>get current working directory</em>. Executing this command will tell us where we are in our computer’s directory. The other command is <code class="docutils literal notranslate"><span class="pre">listdir()</span></code> which stands from <em>list directory</em>. This command tells the Jupyter notebook to display a list of the files and directories in the current working directory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span> <span class="c1"># imports the os library so you can use its functions</span>
<span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="c1"># provides the full file path for the current working directory</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;/home/runner/work/python-scripting-biochemistry/python-scripting-biochemistry/biochemist-python/chapters&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span> <span class="c1"># provides a list of all files in the current working directory</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Linear_Regression.ipynb&#39;,
 &#39;Creating_Plots_in_Jupyter_Notebooks.ipynb&#39;,
 &#39;images&#39;,
 &#39;resolutions.txt&#39;,
 &#39;data&#39;,
 &#39;introduction.ipynb&#39;,
 &#39;Bradford_plot3.png&#39;,
 &#39;File_Parsing.ipynb&#39;,
 &#39;Bradford_plot2.png&#39;,
 &#39;Bradford_plot.png&#39;,
 &#39;Processing_Multiple_Files_and_Writing_Files.ipynb&#39;,
 &#39;ligands&#39;,
 &#39;Working_with_Pandas.ipynb&#39;,
 &#39;nonlinear_regression_part_2.ipynb&#39;,
 &#39;MolVis_with_iCN3D.ipynb&#39;,
 &#39;.ipynb_checkpoints&#39;,
 &#39;workshop_schedule.ipynb&#39;,
 &#39;data.zip&#39;,
 &#39;setup.ipynb&#39;,
 &#39;biopython_mmcif.ipynb&#39;,
 &#39;SmallMolVis.ipynb&#39;,
 &#39;Modifying_Ligands_with_rdkit.ipynb&#39;,
 &#39;rcsb_api.ipynb&#39;,
 &#39;nonlinear_regression_part_1.ipynb&#39;,
 &#39;EC_class_ligands_search.ipynb&#39;]
</pre></div>
</div>
</div>
</div>
<p>The list contains files that end with tags that tell you what they are. Here are three examples.</p>
<ol class="arabic simple">
<li><p>.ipynb is a Jupyter notebook</p></li>
<li><p>.csv is a file containing data as comma separated values</p></li>
<li><p>.png is a <em>portable network graphics</em> file - an image file that is useful on web pages</p></li>
</ol>
<p>There are also two directories in this folder: images and data. You can use the <code class="docutils literal notranslate"><span class="pre">listdir()</span></code> function to find out what is in a directory if you enter the name of the directory within quotes inside the parentheses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ligand13Uipr-3D.sdf&#39;,
 &#39;Ground_water.csv&#39;,
 &#39;AP_kinetics.csv&#39;,
 &#39;protein_assay.csv&#39;,
 &#39;ligand13Ume-3D.sdf&#39;,
 &#39;MM_data_for_NLRpt2.csv&#39;,
 &#39;MM_data1.csv&#39;,
 &#39;protein_assay2.csv&#39;,
 &#39;MM_data.csv&#39;,
 &#39;enzyme_kinetics.xlsx&#39;,
 &#39;chymo_MM_data.csv&#39;,
 &#39;PDB_files&#39;,
 &#39;enzyme_kinetics.csv&#39;,
 &#39;thrombin_with_ligands.csv&#39;,
 &#39;AP_kin.csv&#39;,
 &#39;ligand13Un-3D.sdf&#39;,
 &#39;chymotrypsin_kinetics.xlsx&#39;,
 &#39;protein_samples.csv&#39;,
 &#39;chymotrypsin_kinetics.csv&#39;,
 &#39;ligand13U-3D.sdf&#39;]
</pre></div>
</div>
</div>
</div>
<p>Notice there is a directory called PDB_files. To look at the contents of that directory, just enter ‘data/PDB_files’ within the parentheses for <code class="docutils literal notranslate"><span class="pre">listdir()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;data/PDB_files&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;7tim.pdb&#39;,
 &#39;5eu9.pdb&#39;,
 &#39;4eyr.pdb&#39;,
 &#39;1a6n.cif&#39;,
 &#39;1pmb.cif&#39;,
 &#39;1mbn.cif&#39;,
 &#39;3iva.pdb&#39;,
 &#39;5veu.pdb&#39;,
 &#39;5rsa.cif&#39;,
 &#39;6zt7.pdb&#39;,
 &#39;1a1t.cif&#39;,
 &#39;3vnd.pdb&#39;,
 &#39;2pkr.pdb&#39;,
 &#39;1ddo.pdb&#39;]
</pre></div>
</div>
</div>
</div>
<p>When we write a script, we want it to be usable on any operating system, thus we will use a python function called <code class="docutils literal notranslate"><span class="pre">os.path.join</span></code> that will allow us to define file paths in a general way that will work on Windows, Mac OS or Linux.</p>
<p>Now we know where 4eyr.pdb is located. To access this file from a Jupyter notebook on any operating system, we can use <code class="docutils literal notranslate"><span class="pre">os.path.join</span></code> from the <code class="docutils literal notranslate"><span class="pre">os</span></code> library to create a variable that points directly to this file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;PDB_files&#39;</span><span class="p">,</span> <span class="s1">&#39;4eyr.pdb&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">protein_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data/PDB_files/4eyr.pdb
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here, we have specified that our filepath contains the ‘data’ and ‘PDB_files’ directory, and the <code class="docutils literal notranslate"><span class="pre">os.path</span></code> module has made this into a filepath that is usable by our system.</p>
</div>
</section>
</section>
<section id="absolute-and-relative-paths">
<h2>Absolute and relative paths<a class="headerlink" href="#absolute-and-relative-paths" title="Link to this heading">#</a></h2>
<p>File paths can be <em>absolute</em>, or <em>relative</em>.</p>
<p>A relative file path gives the location relative to the directory we are in. Thus, if we are in the <code class="docutils literal notranslate"><span class="pre">biochemist-python</span></code> directory, the relative filepath for the <code class="docutils literal notranslate"><span class="pre">4eyr.pdb</span></code> file would be <code class="docutils literal notranslate"><span class="pre">chapters/data/PDB_files/4eyr.pdb</span></code></p>
<p>An absolute filepath gives the complete path to a file. This could file path could be used from anywhere on a computer, and would access the same file. For example, the absolute filepath to the <code class="docutils literal notranslate"><span class="pre">4eyr.pdb</span></code> file on a Mac might be <code class="docutils literal notranslate"><span class="pre">/Users/YOUR_USER_NAME/Desktop/python-scripting-biochemistry/biochemist-python/chapters/data/PDB_files/4eyr.pdb</span></code>. You can get the absolute path of a file using <code class="docutils literal notranslate"><span class="pre">os.path.abspath(path)</span></code>, where path is the relative path of the file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We are working with the <code class="docutils literal notranslate"><span class="pre">os.path</span></code> module here, and this is how you will see people handle file paths in most Python code. However, as of Python 3.6, there is also a <code class="docutils literal notranslate"><span class="pre">pathlib</span></code> module in the Python standard library that can be used to represent and manipulate filepaths. <code class="docutils literal notranslate"><span class="pre">os.path</span></code> works with filepaths as strings, while in the <code class="docutils literal notranslate"><span class="pre">pathlib</span></code> module, paths are objects. A good overview of the pathlib module can be found <a class="reference external" href="https://realpython.com/python-pathlib/">here</a>.</p>
</div>
</section>
<section id="reading-a-file">
<h2>Reading a file<a class="headerlink" href="#reading-a-file" title="Link to this heading">#</a></h2>
<p>In Python, there are many ways to read in information from a text file.  The best method to use depends on the type of data and the type of analysis you are performing.  If you have a file with lots of different types of information, text and numbers, with different types of formatting, the most generic way to read in information is the <code class="docutils literal notranslate"><span class="pre">readlines()</span></code> function.  Reading in the file is a two-step process. First, you have to open the file using the file path we defined above. This creates a file object, or filehandle. Then you can read in information with the <code class="docutils literal notranslate"><span class="pre">readlines()</span></code> function.</p>
<p>We could use the following code to accomplish this task:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">protein_file</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">outfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
<p>After you open and read information from a file object, you must close the file. In this example, the command would be</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>There is a second option for opening files - to use a context manager(that is to say, using the word <code class="docutils literal notranslate"><span class="pre">with</span></code> from the beginning). This is actually the preferred way to open files, and prevents you from having to remember to close the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">protein_file</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">outfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This code opens a file for reading and assigns it to the filehandle  <code class="docutils literal notranslate"><span class="pre">outfile</span></code>. The <code class="docutils literal notranslate"><span class="pre">r</span></code> argument in the function stands for <code class="docutils literal notranslate"><span class="pre">read</span></code>. Other arguments might be <code class="docutils literal notranslate"><span class="pre">w</span></code> for <code class="docutils literal notranslate"><span class="pre">write</span></code> if we want to write new information to the file, or <code class="docutils literal notranslate"><span class="pre">a</span></code> for append if we want to add new information at the end of the file.</p>
<p>In the next line, we use the <code class="docutils literal notranslate"><span class="pre">readlines()</span></code> function to get our file as a list of strings.  Notice the dot notation introduced last lesson; readlines acts on the file object given to the left of the dot.  The function creates a list called data where each element of the list is a string that is one line of the file.  This is always how the <code class="docutils literal notranslate"><span class="pre">readlines()</span></code> function works.</p>
<p>The file we will be analyzing in this example is a <a class="reference external" href="https://www.rcsb.org/structure/4EYR">PDB web site</a> file for an HIV protease complex with the inhibitor Ritonavir.</p>
</section>
<section id="readlines-function-behavior">
<h2><code class="docutils literal notranslate"><span class="pre">readlines</span></code> function behavior<a class="headerlink" href="#readlines-function-behavior" title="Link to this heading">#</a></h2>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">readlines</span></code> function can only be used on a file object one time. If you forget to set <code class="docutils literal notranslate"><span class="pre">outfile.readlines()</span></code> equal to a variable, you must <code class="docutils literal notranslate"><span class="pre">open</span></code> the file again in order to get the contents of the file.</p>
<div class="exercise admonition">
<p class="admonition-title">Check Your Understanding</p>
<p>Check that your file was read in correctly by determining how many lines are in the file.</p>
<div class="solution dropdown admonition">
<p class="admonition-title">Answer</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> 
    
<span class="mi">2232</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="searching-for-a-pattern-in-your-file">
<h2>Searching for a pattern in your file<a class="headerlink" href="#searching-for-a-pattern-in-your-file" title="Link to this heading">#</a></h2>
<p>The file we opened is the complete PDB file for the <a class="reference external" href="https://www.rcsb.org/structure/4EYR">Crystal structure of multidrug-resistant clinical isolate 769 HIV-1 protease in complex with ritonavir</a>.  As stated previously, the <code class="docutils literal notranslate"><span class="pre">readlines()</span></code> function put the file contents into a list where each element is a line of the file. You may remember from lesson 1 that a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop can be used to execute the same code repeatedly. As we learned in the previous lesson, we can use a for loop to iterate through elements in a list.</p>
<p>Here’s the code we could use to take a look at what’s in the file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
<p>Here are the first five lines that would result from running this code on 4eyr.pdb:</p>
<p>HEADER    HYDROLASE/HYDROLASE INHIBITOR           01-MAY-12   4EYR</p>
<p>TITLE     CRYSTAL STRUCTURE OF MULTIDRUG-RESISTANT CLINICAL ISOLATE 769 HIV-1</p>
<p>TITLE    2 PROTEASE IN COMPLEX WITH RITONAVIR</p>
<p>CAVEAT     4EYR    LIGAND RIT HAS LOW CORRELATION AND HIGH REAL SPACE R VALUE.</p>
<p>COMPND    MOL_ID: 1;</p>
<p>If you look through 4eyr.pdb in a text editor, you will find one line that starts with HETNAM. This line contains information about the ligand or heterogen (in PDB terms) that is bound to HIV protease in this structure, providing both the abbreviation (RIT) and the full name of the drug (RITONAVIR).  We want to search through this file and find that line, and print only that line. We can do this using an <code class="docutils literal notranslate"><span class="pre">if</span></code> statement.</p>
<p>Returning to our file example,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;HETNAM&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
        <span class="n">HETNAM_line</span> <span class="o">=</span> <span class="n">line</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">HETNAM_line</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HETNAM     RIT RITONAVIR                                                        
</pre></div>
</div>
</div>
</div>
<p>Remember that <code class="docutils literal notranslate"><span class="pre">readlines()</span></code> saves each line of the file as a string, so <code class="docutils literal notranslate"><span class="pre">HETNAM_line</span></code> is a string that contains the whole line.  For our analysis, if we are most interested in the abbreviation for the drug, we need to split up the line so we can save just that abbreviation as a different variable name. To do this, we can use a function called <code class="docutils literal notranslate"><span class="pre">split</span></code>.  The <code class="docutils literal notranslate"><span class="pre">split</span></code> function takes a string and divides it into its components using a <em>delimiter</em>.</p>
<p>The <em>delimiter</em> is specified as an argument to the function (put in the parenthesis <code class="docutils literal notranslate"><span class="pre">()</span></code>). If you do not specify a delimiter, a space is used by default. Let’s try this out.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HETNAM_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;HETNAM&#39;, &#39;RIT&#39;, &#39;RITONAVIR&#39;]
</pre></div>
</div>
</div>
</div>
<p>We can save the output of this function to a variable as a new list. In the example below, we take the line we found in the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop and split it up into its individual words.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">words</span> <span class="o">=</span> <span class="n">HETNAM_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;HETNAM&#39;, &#39;RIT&#39;, &#39;RITONAVIR&#39;]
</pre></div>
</div>
</div>
</div>
<p>From this <code class="docutils literal notranslate"><span class="pre">print</span></code> statement, we now see that we have a list called words, where we have split <code class="docutils literal notranslate"><span class="pre">HETNAM_line</span></code>.  The abbreviation is actually the second element of this list, so we can now save it as a new variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abbrev</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">abbrev</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RIT
</pre></div>
</div>
</div>
</div>
<div class="exercise admonition">
<p class="admonition-title">Check Your Understanding</p>
<p>Some PDB files contain more than one heterogen. For example, the structure of D-amino acid oxidase found in PDB entry 1ddo contains three heterogens. Can you think of a way to keep all of the lines using syntax we have already learned?</p>
<div class="solution dropdown admonition">
<p class="admonition-title">Solution</p>
<p>You will need to create an empty list and append each answer to the list.</p></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use os to assign the file path to a variable</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">protein_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;PDB_files&#39;</span><span class="p">,</span><span class="s1">&#39;1ddo.pdb&#39;</span><span class="p">)</span>

<span class="c1"># Create a list to hold the heterogen information</span>
<span class="n">HETNAM_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Use the with context manager to open the file, </span>
<span class="c1"># then a for loop to populate HETNAM_list</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">protein_file</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">outfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;HETNAM&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">HETNAM_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">HETNAM_list</span><span class="p">)</span>      
</pre></div>
</div>
</div>
</div>
<p>We might also want to extract the number of atoms in the protein in this file. We will modify the above steps to achieve the desired result. We will be looking for the line that contains the term <code class="docutils literal notranslate"><span class="pre">PROTEIN</span> <span class="pre">ATOMS</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;PROTEIN ATOMS&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
        <span class="n">PROTEIN_ATOM_line</span> <span class="o">=</span> <span class="n">line</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">PROTEIN_ATOM_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">PROTEIN_ATOM_line</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>REMARK   3   PROTEIN ATOMS            : 1514                                    
</pre></div>
</div>
</div>
</div>
<p>We can see that the fifth element in this list is a colon (:). It is possible to modify the split command to split lines using the colon as the delimiter (‘:’).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;PROTEIN ATOMS&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
        <span class="n">PROTEIN_ATOM_line</span> <span class="o">=</span> <span class="n">line</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">PROTEIN_ATOM_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;REMARK   3   PROTEIN ATOMS            &#39;, &#39; 1514                                    \n&#39;]
</pre></div>
</div>
</div>
</div>
<p>From this <code class="docutils literal notranslate"><span class="pre">print</span></code> statement, we now see that we have a list called words, where we have split <code class="docutils literal notranslate"><span class="pre">PROTEIN_ATOM_line</span></code>.  The number of atoms in the protein is actually the second element of this list, so we can now save it as a new variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atoms</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 1514                                    
</pre></div>
</div>
</div>
</div>
<p>The HIV protease structure in 4eyr.pdb is a dimer. Let’s find the number of atoms in each monomer unit. If we now try to do a math operation on atoms, we get an error message.  Why do you think that is?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atoms</span> <span class="o">/</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">atoms</span> <span class="o">/</span> <span class="mi">2</span>

<span class="ne">TypeError</span>: unsupported operand type(s) for /: &#39;str&#39; and &#39;int&#39;
</pre></div>
</div>
</div>
</div>
<p>Even though <code class="docutils literal notranslate"><span class="pre">atoms</span></code> looks like a number to us, it is really a string, so we can use it for a math operation.  We need to change the data type of atoms to a float. This is called <em>casting</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atoms</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
<span class="n">atoms</span> <span class="o">/</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Now it works.  If we thought ahead we could have changed the data type when we assigned the variable originally.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atoms</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="exercise admonition">
<p class="admonition-title">Exerise on file parsing</p>
<p>Use skills from this lesson and the previous lesson to extract the experimental method and temperature for determining the structure of 4eyr.pdb.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EXPERIMENT</span> <span class="n">TYPE</span> <span class="p">:</span> <span class="n">X</span><span class="o">-</span><span class="n">RAY</span> <span class="n">DIFFRACTION</span>
<span class="n">TEMPERATURE</span> <span class="p">(</span><span class="n">KELVIN</span><span class="p">)</span> <span class="p">:</span> <span class="mi">298</span>
</pre></div>
</div>
<div class="solution dropdown admonition">
<p class="admonition-title">Hint</p>
<ul class="simple">
<li><p>Remember that you can only use readlines once. You will need to reopen the file to read it again</p></li>
<li><p>To find the lines with the keywords, do a search and then print the lines to see their content. Then you can refine your search and split the lines as needed to get the desired output</p></li>
</ul>
</div>
<div class="solution dropdown admonition">
<p class="admonition-title">Solution</p>
<p>This is one possible solution for the file parsing exercise.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">protein_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;PDB_files&#39;</span><span class="p">,</span><span class="s1">&#39;4eyr.pdb&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">protein_file</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">protein_file</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">outfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;EXPERIMENT TYPE&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">exp_type_line</span> <span class="o">=</span> <span class="n">line</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">exp_type_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>  <span class="c1"># to remove the . from RESOLUTION.</span>
            <span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">words</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;KELVIN&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">temp_line</span> <span class="o">=</span> <span class="n">line</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">temp_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">words</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="searching-for-a-particular-line-number-in-your-file">
<h2>Searching for a particular line number in your file<a class="headerlink" href="#searching-for-a-particular-line-number-in-your-file" title="Link to this heading">#</a></h2>
<p>There is a lot of other information in the PDB file that might be of interest.  For example, we might want to pull out the sequence of the protein.  If we look through the file, 4eyr.pdb, in a text editor, we notice that the sequence is given in a series of lines that begin with <code class="docutils literal notranslate"><span class="pre">SEQRES</span></code></p>
<p>SEQRES   1 A   99  PRO GLN ILE THR LEU TRP GLN ARG PRO ILE VAL THR ILE</p>
<p>followed by a series of lines that contain the full sequence using three letter abbreviations for the amino acids.  In this case, we don’t want to pull something out of this line, as we did in our previous example, but we want to know which line of the file this is so that we can then pull the sequence from the next few lines.</p>
<p>When you use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop, it is easy to have python keep up with the line numbers using the <code class="docutils literal notranslate"><span class="pre">enumerate</span></code> command.  The general syntax is</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">linenum</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">list_name</span><span class="p">):</span>
    <span class="n">do</span> <span class="n">things</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">loop</span>
</pre></div>
</div>
<p>In this notation, there are now <em>two</em> variables you can use in your loop commands, <code class="docutils literal notranslate"><span class="pre">linenum</span></code> (which can be named something else) will keep up with what iteration you are on in the loop, in this case what line you are on in the file. The variable <code class="docutils literal notranslate"><span class="pre">line</span></code> (which could be named something else) functions exactly as it did before, holding the actual information from the list.  Finally, instead of just giving the list name you use <code class="docutils literal notranslate"><span class="pre">enumerate(list_name)</span></code>.</p>
<p>This block of code searches our file for the line that contains “SEQRES” and reports the line number.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">protein_file</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">outfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">linenum</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;SEQRES   1 A&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">linenum</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we know that this is line 310 in our file (remember that you start counting at zero!).</p>
<div class="exercise admonition">
<p class="admonition-title">Check your Understanding</p>
<p>What would be printed if you entered the following?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">311</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">312</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">313</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">314</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">315</span><span class="p">])</span>
</pre></div>
</div>
<div class="solution dropdown admonition">
<p class="admonition-title">Answer</p>
<p>It prints line 311-315 of the list data which is the first line that contains “SEQRES 1 A” and then the sequence information for the next 5 lines from the PDB file for 7TIM.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">311</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">312</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">313</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">314</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">315</span><span class="p">])</span>

<span class="n">SEQRES</span>   <span class="mi">2</span> <span class="n">A</span>   <span class="mi">99</span>  <span class="n">LYS</span> <span class="n">ILE</span> <span class="n">GLY</span> <span class="n">GLY</span> <span class="n">GLN</span> <span class="n">LEU</span> <span class="n">LYS</span> <span class="n">GLU</span> <span class="n">ALA</span> <span class="n">LEU</span> <span class="n">LEU</span> <span class="n">ASN</span> <span class="n">THR</span>          

<span class="n">SEQRES</span>   <span class="mi">3</span> <span class="n">A</span>   <span class="mi">99</span>  <span class="n">GLY</span> <span class="n">ALA</span> <span class="n">ASP</span> <span class="n">ASP</span> <span class="n">THR</span> <span class="n">VAL</span> <span class="n">LEU</span> <span class="n">GLU</span> <span class="n">GLU</span> <span class="n">VAL</span> <span class="n">ASN</span> <span class="n">LEU</span> <span class="n">PRO</span>          

<span class="n">SEQRES</span>   <span class="mi">4</span> <span class="n">A</span>   <span class="mi">99</span>  <span class="n">GLY</span> <span class="n">ARG</span> <span class="n">TRP</span> <span class="n">LYS</span> <span class="n">PRO</span> <span class="n">LYS</span> <span class="n">LEU</span> <span class="n">ILE</span> <span class="n">GLY</span> <span class="n">GLY</span> <span class="n">ILE</span> <span class="n">GLY</span> <span class="n">GLY</span>          

<span class="n">SEQRES</span>   <span class="mi">5</span> <span class="n">A</span>   <span class="mi">99</span>  <span class="n">PHE</span> <span class="n">VAL</span> <span class="n">LYS</span> <span class="n">VAL</span> <span class="n">ARG</span> <span class="n">GLN</span> <span class="n">TYR</span> <span class="n">ASP</span> <span class="n">GLN</span> <span class="n">VAL</span> <span class="n">PRO</span> <span class="n">ILE</span> <span class="n">GLU</span>          

<span class="n">SEQRES</span>   <span class="mi">6</span> <span class="n">A</span>   <span class="mi">99</span>  <span class="n">ILE</span> <span class="n">CYS</span> <span class="n">GLY</span> <span class="n">HIS</span> <span class="n">LYS</span> <span class="n">VAL</span> <span class="n">ILE</span> <span class="n">GLY</span> <span class="n">THR</span> <span class="n">VAL</span> <span class="n">LEU</span> <span class="n">VAL</span> <span class="n">GLY</span>          
</pre></div>
</div>
</div>
</div>
</section>
<section id="a-final-note-about-regular-expressions">
<h2>A final note about regular expressions<a class="headerlink" href="#a-final-note-about-regular-expressions" title="Link to this heading">#</a></h2>
<p>Sometimes you will need to match something more complex than just a particular word or phrase in your output file.  Sometimes you will need to match a particular word, but only if it is found at the beginning of a line.  Or perhaps you will need to match a particular pattern of data, like a capital letter followed by a number, but you won’t know the exact letter and number you are looking for.  These types of matching situations are handled with something called <em>regular expressions</em> which is accessed through the python module <code class="docutils literal notranslate"><span class="pre">re</span></code>.  While using regular expressions is outside the scope of this tutorial, they are very useful and you might want to learn more about them in the future.  A tutorial can be found at <a class="reference external" href="https://automatetheboringstuff.com/2e/chapter7/">Automate the Boring Stuff with Python book</a>. A great test site for regex is <a class="reference external" href="https://regex101.com/">here</a>.</p>
<div class="key admonition">
<p class="admonition-title">Key Points</p>
<ul class="simple">
<li><p>You should use the os.path module to work with file paths.</p></li>
<li><p>One of the most flexible ways to read in the lines of a file is the <code class="docutils literal notranslate"><span class="pre">readlines()</span></code> function.</p></li>
<li><p>An <ital>if</ital> statement can be used to find a particular string within a file.</p></li>
<li><p>The split() function can be used to seperate the elements of a string.</p></li>
<li><p>You will often need to recast data into a different data type when it was read in as a string.</p></li>
</ul>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="introduction.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction</p>
      </div>
    </a>
    <a class="right-next"
       href="Processing_Multiple_Files_and_Writing_Files.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Processing Multiple Files and Writing Files</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-files">Working with files</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-file-paths-the-os-path-module">Working with file paths - the <code class="docutils literal notranslate"><span class="pre">os.path</span></code> module</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#absolute-and-relative-paths">Absolute and relative paths</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-a-file">Reading a file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#readlines-function-behavior"><code class="docutils literal notranslate"><span class="pre">readlines</span></code> function behavior</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-a-pattern-in-your-file">Searching for a pattern in your file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-a-particular-line-number-in-your-file">Searching for a particular line number in your file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-final-note-about-regular-expressions">A final note about regular expressions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Molecular Sciences Software Institute
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>