
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Investigation the Binding Site &#8212; Python Data and Scripting for Biochemists and Molecular Biologists</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=0905f21a" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-FHKVGE8HKZ"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-FHKVGE8HKZ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-FHKVGE8HKZ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/binding_site_investigation';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Enzyme Commission Class with Ligands" href="EC_class_ligands_search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="setup.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/molssi_main_logo.png" class="logo__image only-light" alt="Python Data and Scripting for Biochemists and Molecular Biologists - Home"/>
    <script>document.write(`<img src="../_static/molssi_main_logo_inverted_white.png" class="logo__image only-dark" alt="Python Data and Scripting for Biochemists and Molecular Biologists - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="workshop_schedule.html">Workshop Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="File_Parsing.html">File Parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Processing_Multiple_Files_and_Writing_Files.html">Processing Multiple Files and Writing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Working_with_Pandas.html">Working with Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Linear_Regression.html">Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="Creating_Plots_in_Jupyter_Notebooks.html">Creating Plots in Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinear_regression_part_1.html">Nonlinear Regression Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinear_regression_part_2.html">Nonlinear Regression Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="biopython_mmcif.html">Analyzing MMCIF Files using Biopython</a></li>
<li class="toctree-l1"><a class="reference internal" href="rcsb_api.html">Retrieving Information from the PDB using the Web API</a></li>
<li class="toctree-l1"><a class="reference internal" href="MolVis_with_iCN3D.html">Molecular Visualization with iCN3D</a></li>



<li class="toctree-l1"><a class="reference internal" href="EC_class_ligands_search.html">Enzyme Commission Class with Ligands</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Investigation the Binding Site</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/binding_site_investigation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Investigation the Binding Site</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-the-structure">Downloading the Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-the-structure">View the structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#making-a-map-of-ligand-contacts">Making a Map of Ligand Contacts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structure-preparation">Structure Preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-binding-site">Visualizing the Binding Site</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="investigation-the-binding-site">
<h1>Investigation the Binding Site<a class="headerlink" href="#investigation-the-binding-site" title="Link to this heading">#</a></h1>
<p>Learning Objectives</p>
<ul class="simple">
<li><p>Use NGLView to view the 3D structure of our protein and ligand.</p></li>
<li><p>Prepare molecule structures using <a class="reference external" href="https://pdb2pqr.readthedocs.io/en/latest/">PDQ2PQR</a> and <a class="reference external" href="https://www.rdkit.org/">RDKit</a>.</p></li>
<li><p>Analyze the interactions of the protein in the binding site using a 2D map and <a class="reference external" href="https://prolif.readthedocs.io/en/stable/">ProLIF</a>.</p></li>
</ul>
<p>Before we begin our docking calculations, we will likely want to investigate the binding site of our ligand of interest.
We will want to look at the binding pocket and the interactions of the ligand with the protein residues.
For the rest of our studies, we will choose the ligand <a class="reference external" href="https://www.rcsb.org/ligand/13U"><code class="docutils literal notranslate"><span class="pre">13U</span></code></a>.
A trypsin structure where this ligand is bound is 2ZQ2.</p>
<section id="downloading-the-structure">
<h2>Downloading the Structure<a class="headerlink" href="#downloading-the-structure" title="Link to this heading">#</a></h2>
<p>First we will need to download our protein structure. We will download <a class="reference external" href="https://www.rcsb.org/structure/2zq2">2ZQ2</a>, which is a trypsin structure with our ligand of interest bound.</p>
<p>We will use a similar strategy to our last notebook for getting the file.
We will use Python’s request module and a URL from the Protein Data Bank.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span> <span class="c1"># for making directories</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="c1"># make a directory for pdb files</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">pdb_id</span> <span class="o">=</span> <span class="s2">&quot;2zq2&quot;</span> <span class="c1"># trypsin PDB file with ligand bound</span>

<span class="n">pdb_request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;https://files.rcsb.org/download/</span><span class="si">{</span><span class="n">pdb_id</span><span class="si">}</span><span class="s2">.pdb&quot;</span><span class="p">)</span>
<span class="n">pdb_request</span><span class="o">.</span><span class="n">status_code</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>200
</pre></div>
</div>
</div>
</div>
<p>After downloading, we will write the text to a file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/</span><span class="si">{</span><span class="n">pdb_id</span><span class="si">}</span><span class="s2">.pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pdb_request</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-the-structure">
<h2>View the structure<a class="headerlink" href="#view-the-structure" title="Link to this heading">#</a></h2>
<p>Before we start to really work with our molecule, let’s investigate the structure.
We will use a library called MDAnalysis to first process our PDB, then visualize it with a library called NGLView.
In the cell below, we define some convenience functions for NGLView.
These are functions that the tutorial writers wrote for our protein ligand system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="k">def</span> <span class="nf">rotate_view</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">radians</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span> <span class="n">radians</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
    <span class="n">view</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">spin</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">*</span><span class="n">radians</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">spin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">*</span><span class="n">radians</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">spin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="o">*</span><span class="n">radians</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">view_binding_site</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">ligand</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;View binding site of 13U to trypsin.</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    protein: mda.Universe</span>
<span class="sd">        The protein as an MDAnalysis universe.</span>

<span class="sd">    ligand: mda.Universe</span>
<span class="sd">        The ligand as an MDAnalysis universe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">view</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">show_mdanalysis</span><span class="p">(</span><span class="n">protein</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">clear_representations</span><span class="p">()</span>
    <span class="n">view</span><span class="o">.</span><span class="n">add_representation</span><span class="p">(</span><span class="s2">&quot;surface&quot;</span><span class="p">,</span> <span class="n">colorScheme</span><span class="o">=</span><span class="s2">&quot;hydrophobicity&quot;</span><span class="p">)</span>
    <span class="n">lig_view</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">ligand</span><span class="p">)</span>
    <span class="n">lig_view</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
    <span class="n">rotate_view</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">view</span>
    
</pre></div>
</div>
</div>
</div>
<p>MDAnalysis is a popular tool for processing molecular dynamics trajectories and other molecular structures.
The central object in MDAnalysis is called a “Universe”. In MDAnalysis terms, a Universe represents a molecular
system. We can load an MDAnalysis universe from a PDB file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="kn">import</span> <span class="nn">nglview</span> <span class="k">as</span> <span class="nn">nv</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/</span><span class="si">{</span><span class="n">pdb_id</span><span class="si">}</span><span class="s2">.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "8929d9407c0c4f3a901602eb10536005"}</script></div>
</div>
<p>Text here about NGLView</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">show_mdanalysis</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "be786c941878415e86cc90e12a93464c"}</script></div>
</div>
<p>This view looks a bit messy. MDAnalysis has a human readable <a class="reference external" href="https://docs.mdanalysis.org/stable/documentation_pages/selections.html">selection syntax</a>
that allows us to isolate parts of our structure. We will take our MDAnalysis Universe (the variable <code class="docutils literal notranslate"><span class="pre">u</span></code>) and use the <code class="docutils literal notranslate"><span class="pre">select_atoms</span></code> function.
Inside this function, we will fill in what we want to select.</p>
<p>We will create separate variables for the protein and ligand. We can select all protein residues in MDAnalysis using the word “protein” in the <code class="docutils literal notranslate"><span class="pre">select_atoms</span></code> function. Then, we will select our ligand using <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">13U</span></code>. This corresponds to the residue name in the PDB we downloaded.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>
<span class="n">ligand</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;resname 13U&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We will use our helper function, defined above, to look at how the ligand is bound to the protein.
This helper function will use NGLView, like we did previously, but adds coloring the surface by hydrophobicity.
It also zooms in on the ligand.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_binding_site</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">ligand</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "c47fd4934e07462eb663746111c82490"}</script></div>
</div>
<p>Upon viewing this structure, you will notice that our ligand seems to appear twice.
If you open the PDB file to investigate, you will see the following in the ligand section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HETATM</span> <span class="mi">1673</span>  <span class="n">C14A13U</span> <span class="n">A</span> <span class="mi">501</span>      <span class="mf">18.144</span>  <span class="o">-</span><span class="mf">9.216</span>  <span class="mf">12.088</span>  <span class="mf">0.61</span> <span class="mf">24.22</span>           <span class="n">C</span>  
<span class="n">ANISOU</span> <span class="mi">1673</span>  <span class="n">C14A13U</span> <span class="n">A</span> <span class="mi">501</span>     <span class="mi">1755</span>   <span class="mi">4793</span>   <span class="mi">2654</span>   <span class="mi">1752</span>    <span class="mi">148</span>   <span class="mi">1233</span>       <span class="n">C</span>  
<span class="n">HETATM</span> <span class="mi">1674</span>  <span class="n">C14B13U</span> <span class="n">A</span> <span class="mi">501</span>      <span class="mf">18.147</span>  <span class="o">-</span><span class="mf">8.840</span>  <span class="mf">11.672</span>  <span class="mf">0.39</span> <span class="mf">24.46</span>           <span class="n">C</span>  
<span class="n">ANISOU</span> <span class="mi">1674</span>  <span class="n">C14B13U</span> <span class="n">A</span> <span class="mi">501</span>     <span class="mi">2583</span>   <span class="mi">4283</span>   <span class="mi">2430</span>   <span class="mi">1765</span>    <span class="mi">353</span>   <span class="mi">1279</span>       <span class="n">C</span>  
<span class="n">HETATM</span> <span class="mi">1675</span>  <span class="n">O32A13U</span> <span class="n">A</span> <span class="mi">501</span>      <span class="mf">18.209</span>  <span class="o">-</span><span class="mf">8.355</span>  <span class="mf">11.186</span>  <span class="mf">0.61</span> <span class="mf">24.38</span>           <span class="n">O</span>  
<span class="n">ANISOU</span> <span class="mi">1675</span>  <span class="n">O32A13U</span> <span class="n">A</span> <span class="mi">501</span>     <span class="mi">2354</span>   <span class="mi">5394</span>   <span class="mi">1514</span>   <span class="mi">2217</span>    <span class="mi">238</span>    <span class="mi">919</span>       <span class="n">O</span>
</pre></div>
</div>
<p>This PDB structure provides <strong>alternate locations</strong> for each ligand atom. In excerpt above, you will see C14A13U and C14B13U. These are alternate locations of the same atom.
By checking the <a class="reference external" href="https://docs.mdanalysis.org/stable/documentation_pages/selections.html">documentation page</a> for MDAnalysis selections, we can see that MDAnalysis is prepared for this scenario. We will want to use the <code class="docutils literal notranslate"><span class="pre">altloc</span></code> keyword. This keyword is described as:</p>
<blockquote>
<div><p>altLoc alternative-location</p>
</div></blockquote>
<blockquote>
<div><p>a selection for atoms where alternative locations are available, which is often the case with high-resolution crystal structures e.g. resid 4 and resname ALA and altLoc B selects only the atoms of ALA-4 that have an altLoc B record.</p>
</div></blockquote>
<p>We can alter our MDAnalysis selection syntax to isolate our ligands of interest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>
<span class="n">ligand_A</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;resname 13U and altLoc A&quot;</span><span class="p">)</span>
<span class="n">ligand_B</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;resname 13U and altLoc B&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we can use our viewing function to see the location of each ligand.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_binding_site</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">ligand_A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "4136366901c441e7b956a21a2a1c535e"}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_binding_site</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">ligand_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "3e61bdebbe3444d681accdeadf8819c7"}</script></div>
</div>
<p>When we inspect the ligand in the binding site, we notice a few things.
First, the binding site has a large hydrophobic area on the surface.
If you zoom in on the binding pocket, you’ll also see that the benzene ring and amine groups are inside.</p>
</section>
<section id="making-a-map-of-ligand-contacts">
<h2>Making a Map of Ligand Contacts<a class="headerlink" href="#making-a-map-of-ligand-contacts" title="Link to this heading">#</a></h2>
<p>To get an even better idea of how our ligand is binding to the protein, we might choose to make a 2D map of ligand contacts with protein residues.
In this analysis, we’ll want to know how the ligand is interacting with the protein residues including if it is making hydrogen bonds, Van Der Waals interactions, etc.</p>
<p>We will use a library called <a class="reference external" href="https://prolif.readthedocs.io/en/stable/">ProLIF</a> for this analysis. ProLIF is short for “Protein-Ligand Interaction Fingerprints” and it “ is a tool designed to generate interaction fingerprints for complexes made of ligands, protein, DNA or RNA molecules extracted from molecular dynamics trajectories, docking simulations and experimental structures.” (quote taken from ProLIF docs).</p>
<p>Before we use ProLIF, we first have to make sure our ligand and protein file are prepared properly.
Hydrogens are absent in most PDB files because they are not well resolved by methods like X-Ray crystallography.
We’ll need to add them back in in order to complete our analysis of the binding site.</p>
<p>This process can actually be quite involved, as we’ll see below.</p>
<p>We will start by saving new PDBs of our selections from MDAnalysis.
Then, we will add hydrogens.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/protein_</span><span class="si">{</span><span class="n">pdb_id</span><span class="si">}</span><span class="s2">.pdb&quot;</span><span class="p">)</span>
<span class="n">ligand_A</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/ligand_A.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/coordinates/PDB.py:1153: UserWarning: Found no information for attr: &#39;formalcharges&#39; Using default value of &#39;0&#39;
  warnings.warn(&quot;Found no information for attr: &#39;{}&#39;&quot;
</pre></div>
</div>
</div>
</div>
<section id="structure-preparation">
<h3>Structure Preparation<a class="headerlink" href="#structure-preparation" title="Link to this heading">#</a></h3>
<p>Before we run the analysis, we need to make sure our protein and ligand have hydrogen atoms.
We will do this first for the protein.</p>
<p>We will use a specialized program called PDB2PQR that is made for working with biomolecules like proteins.
The advantage of using PDB2PQR is that it will check our protein for missing atoms and multiple occupancy in the protein.</p>
<p>We will use the command-line interface of this program. This means that you would usually type the command below into your terminal
You can run command line commands in the Jupyter notebook by putting a <code class="docutils literal notranslate"><span class="pre">!</span></code> in front of the command.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>pdb2pqr<span class="w"> </span>--pdb-output<span class="o">=</span>pdb/protein_h.pdb<span class="w"> </span>--pH<span class="o">=</span><span class="m">7</span>.4<span class="w"> </span>pdb/protein_2zq2.pdb<span class="w"> </span>protein.pqr
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/bin/sh: 1: pdb2pqr: not found
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;pdb/protein_H.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
    <span class="p">[</span><span class="o">...</span> <span class="n">skipping</span> <span class="n">hidden</span> <span class="mi">1</span> <span class="n">frame</span><span class="p">]</span>

<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">protein</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;pdb/protein_H.pdb&quot;</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/core/universe.py:356,</span> in <span class="ni">Universe.__init__</span><span class="nt">(self, topology, all_coordinates, format, topology_format, transformations, guess_bonds, vdwradii, fudge_factor, lower_bound, in_memory, in_memory_step, *coordinates, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span>     <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">_check_file_like</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">356</span>     <span class="n">topology</span> <span class="o">=</span> <span class="n">_topology_from_file_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span>                                         <span class="n">topology_format</span><span class="o">=</span><span class="n">topology_format</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span>                                         <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">360</span> <span class="k">if</span> <span class="n">topology</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/core/universe.py:118,</span> in <span class="ni">_topology_from_file_like</span><span class="nt">(topology_file, topology_format, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span> <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>     <span class="n">errno</span><span class="o">.</span><span class="n">errorcode</span><span class="p">[</span><span class="n">err</span><span class="o">.</span><span class="n">errno</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ENOENT&#39;</span><span class="p">,</span> <span class="s1">&#39;EACCES&#39;</span><span class="p">]):</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span>     <span class="c1"># Runs if the error is propagated due to no permission / file not found</span>
<span class="ne">--&gt; </span><span class="mi">118</span>     <span class="k">raise</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">    </span><span class="mi">119</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">120</span>     <span class="c1"># Runs when the parser fails</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/core/universe.py:110,</span> in <span class="ni">_topology_from_file_like</span><span class="nt">(topology_file, topology_format, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span>     <span class="k">with</span> <span class="n">parser</span><span class="p">(</span><span class="n">topology_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">110</span>         <span class="n">topology</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span>     <span class="c1"># There are 2 kinds of errors that might be raised here:</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>     <span class="c1"># one because the file isn&#39;t present</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span>     <span class="c1"># or the permissions are bad, second when the parser fails</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/topology/PDBParser.py:210,</span> in <span class="ni">PDBParser.parse</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">204</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Parse atom information from PDB file</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">206</span><span class="sd"> Returns</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span><span class="sd"> -------</span>
<span class="g g-Whitespace">    </span><span class="mi">208</span><span class="sd"> MDAnalysis Topology object</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">210</span> <span class="n">top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parseatoms</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span> <span class="k">try</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/topology/PDBParser.py:247,</span> in <span class="ni">PDBParser._parseatoms</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span> <span class="n">last_wrapped_serial</span> <span class="o">=</span> <span class="mi">100000</span>  <span class="c1"># if serials wrap, start from here</span>
<span class="ne">--&gt; </span><span class="mi">247</span> <span class="k">with</span> <span class="n">util</span><span class="o">.</span><span class="n">openany</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span>     <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/contextlib.py:137,</span> in <span class="ni">_GeneratorContextManager.__enter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">137</span>     <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span> <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/util.py:318,</span> in <span class="ni">openany</span><span class="nt">(datasource, mode, reset)</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Context manager for :func:`anyopen`.</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">278</span><span class="sd"> Open the `datasource` and close it when the context of the :keyword:`with`</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span><span class="sd"> :func:`anyopen`</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">318</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">anyopen</span><span class="p">(</span><span class="n">datasource</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="n">reset</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span> <span class="k">try</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/util.py:398,</span> in <span class="ni">anyopen</span><span class="nt">(datasource, mode, reset)</span>
<span class="g g-Whitespace">    </span><span class="mi">397</span> <span class="n">openfunc</span> <span class="o">=</span> <span class="n">read_handlers</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">398</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">_get_stream</span><span class="p">(</span><span class="n">datasource</span><span class="p">,</span> <span class="n">openfunc</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">399</span> <span class="k">if</span> <span class="n">stream</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/util.py:440,</span> in <span class="ni">_get_stream</span><span class="nt">(filename, openfunction, mode)</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span> <span class="k">if</span> <span class="n">errno</span><span class="o">.</span><span class="n">errorcode</span><span class="p">[</span><span class="n">err</span><span class="o">.</span><span class="n">errno</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ENOENT&#39;</span><span class="p">,</span> <span class="s1">&#39;EACCES&#39;</span><span class="p">]:</span>
<span class="ne">--&gt; </span><span class="mi">440</span>     <span class="k">raise</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">    </span><span class="mi">441</span> <span class="k">return</span> <span class="kc">None</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/util.py:434,</span> in <span class="ni">_get_stream</span><span class="nt">(filename, openfunction, mode)</span>
<span class="g g-Whitespace">    </span><span class="mi">433</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">434</span>     <span class="n">stream</span> <span class="o">=</span> <span class="n">openfunction</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">435</span> <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">436</span>     <span class="c1"># An exception might be raised due to two reasons, first the openfunction is unable to open the file, in this</span>
<span class="g g-Whitespace">    </span><span class="mi">437</span>     <span class="c1"># case we have to ignore the error and return None. Second is when openfunction can&#39;t open the file because</span>
<span class="g g-Whitespace">    </span><span class="mi">438</span>     <span class="c1"># either the file isn&#39;t there or the permissions don&#39;t allow access.</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/picklable_file_io.py:502,</span> in <span class="ni">bz2_pickle_open</span><span class="nt">(name, mode)</span>
<span class="g g-Whitespace">    </span><span class="mi">501</span> <span class="n">bz_mode</span> <span class="o">=</span> <span class="n">mode</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">502</span> <span class="n">binary_file</span> <span class="o">=</span> <span class="n">BZ2Picklable</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bz_mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">503</span> <span class="k">if</span> <span class="s2">&quot;t&quot;</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/picklable_file_io.py:283,</span> in <span class="ni">BZ2Picklable.__init__</span><span class="nt">(self, name, mode)</span>
<span class="g g-Whitespace">    </span><span class="mi">282</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bz_mode</span> <span class="o">=</span> <span class="n">mode</span>
<span class="ne">--&gt; </span><span class="mi">283</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/bz2.py:81,</span> in <span class="ni">BZ2File.__init__</span><span class="nt">(self, filename, mode, compresslevel)</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">)):</span>
<span class="ne">---&gt; </span><span class="mi">81</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span> <span class="o">=</span> <span class="n">_builtin_open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">82</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_closefp</span> <span class="o">=</span> <span class="kc">True</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;pdb/protein_H.pdb&#39;

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
    <span class="p">[</span><span class="o">...</span> <span class="n">skipping</span> <span class="n">hidden</span> <span class="mi">1</span> <span class="n">frame</span><span class="p">]</span>

<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">protein</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;pdb/protein_H.pdb&quot;</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/core/universe.py:356,</span> in <span class="ni">Universe.__init__</span><span class="nt">(self, topology, all_coordinates, format, topology_format, transformations, guess_bonds, vdwradii, fudge_factor, lower_bound, in_memory, in_memory_step, *coordinates, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span>     <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">_check_file_like</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">356</span>     <span class="n">topology</span> <span class="o">=</span> <span class="n">_topology_from_file_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span>                                         <span class="n">topology_format</span><span class="o">=</span><span class="n">topology_format</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span>                                         <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">360</span> <span class="k">if</span> <span class="n">topology</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/core/universe.py:118,</span> in <span class="ni">_topology_from_file_like</span><span class="nt">(topology_file, topology_format, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span> <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>     <span class="n">errno</span><span class="o">.</span><span class="n">errorcode</span><span class="p">[</span><span class="n">err</span><span class="o">.</span><span class="n">errno</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ENOENT&#39;</span><span class="p">,</span> <span class="s1">&#39;EACCES&#39;</span><span class="p">]):</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span>     <span class="c1"># Runs if the error is propagated due to no permission / file not found</span>
<span class="ne">--&gt; </span><span class="mi">118</span>     <span class="k">raise</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">    </span><span class="mi">119</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">120</span>     <span class="c1"># Runs when the parser fails</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/core/universe.py:110,</span> in <span class="ni">_topology_from_file_like</span><span class="nt">(topology_file, topology_format, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span>     <span class="k">with</span> <span class="n">parser</span><span class="p">(</span><span class="n">topology_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">110</span>         <span class="n">topology</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span>     <span class="c1"># There are 2 kinds of errors that might be raised here:</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>     <span class="c1"># one because the file isn&#39;t present</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span>     <span class="c1"># or the permissions are bad, second when the parser fails</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/topology/PDBParser.py:210,</span> in <span class="ni">PDBParser.parse</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">204</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Parse atom information from PDB file</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">206</span><span class="sd"> Returns</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span><span class="sd"> -------</span>
<span class="g g-Whitespace">    </span><span class="mi">208</span><span class="sd"> MDAnalysis Topology object</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">210</span> <span class="n">top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parseatoms</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span> <span class="k">try</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/topology/PDBParser.py:247,</span> in <span class="ni">PDBParser._parseatoms</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span> <span class="n">last_wrapped_serial</span> <span class="o">=</span> <span class="mi">100000</span>  <span class="c1"># if serials wrap, start from here</span>
<span class="ne">--&gt; </span><span class="mi">247</span> <span class="k">with</span> <span class="n">util</span><span class="o">.</span><span class="n">openany</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span>     <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/contextlib.py:137,</span> in <span class="ni">_GeneratorContextManager.__enter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">137</span>     <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span> <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/util.py:318,</span> in <span class="ni">openany</span><span class="nt">(datasource, mode, reset)</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Context manager for :func:`anyopen`.</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">278</span><span class="sd"> Open the `datasource` and close it when the context of the :keyword:`with`</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span><span class="sd"> :func:`anyopen`</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">318</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">anyopen</span><span class="p">(</span><span class="n">datasource</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="n">reset</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span> <span class="k">try</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/util.py:398,</span> in <span class="ni">anyopen</span><span class="nt">(datasource, mode, reset)</span>
<span class="g g-Whitespace">    </span><span class="mi">397</span> <span class="n">openfunc</span> <span class="o">=</span> <span class="n">read_handlers</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">398</span> <span class="n">stream</span> <span class="o">=</span> <span class="n">_get_stream</span><span class="p">(</span><span class="n">datasource</span><span class="p">,</span> <span class="n">openfunc</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">399</span> <span class="k">if</span> <span class="n">stream</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/util.py:440,</span> in <span class="ni">_get_stream</span><span class="nt">(filename, openfunction, mode)</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span> <span class="k">if</span> <span class="n">errno</span><span class="o">.</span><span class="n">errorcode</span><span class="p">[</span><span class="n">err</span><span class="o">.</span><span class="n">errno</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ENOENT&#39;</span><span class="p">,</span> <span class="s1">&#39;EACCES&#39;</span><span class="p">]:</span>
<span class="ne">--&gt; </span><span class="mi">440</span>     <span class="k">raise</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">    </span><span class="mi">441</span> <span class="k">return</span> <span class="kc">None</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/util.py:434,</span> in <span class="ni">_get_stream</span><span class="nt">(filename, openfunction, mode)</span>
<span class="g g-Whitespace">    </span><span class="mi">433</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">434</span>     <span class="n">stream</span> <span class="o">=</span> <span class="n">openfunction</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">435</span> <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">436</span>     <span class="c1"># An exception might be raised due to two reasons, first the openfunction is unable to open the file, in this</span>
<span class="g g-Whitespace">    </span><span class="mi">437</span>     <span class="c1"># case we have to ignore the error and return None. Second is when openfunction can&#39;t open the file because</span>
<span class="g g-Whitespace">    </span><span class="mi">438</span>     <span class="c1"># either the file isn&#39;t there or the permissions don&#39;t allow access.</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/picklable_file_io.py:502,</span> in <span class="ni">bz2_pickle_open</span><span class="nt">(name, mode)</span>
<span class="g g-Whitespace">    </span><span class="mi">501</span> <span class="n">bz_mode</span> <span class="o">=</span> <span class="n">mode</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">502</span> <span class="n">binary_file</span> <span class="o">=</span> <span class="n">BZ2Picklable</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bz_mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">503</span> <span class="k">if</span> <span class="s2">&quot;t&quot;</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/picklable_file_io.py:283,</span> in <span class="ni">BZ2Picklable.__init__</span><span class="nt">(self, name, mode)</span>
<span class="g g-Whitespace">    </span><span class="mi">282</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bz_mode</span> <span class="o">=</span> <span class="n">mode</span>
<span class="ne">--&gt; </span><span class="mi">283</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/bz2.py:81,</span> in <span class="ni">BZ2File.__init__</span><span class="nt">(self, filename, mode, compresslevel)</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">)):</span>
<span class="ne">---&gt; </span><span class="mi">81</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span> <span class="o">=</span> <span class="n">_builtin_open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">82</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_closefp</span> <span class="o">=</span> <span class="kc">True</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;pdb/protein_H.pdb&#39;

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">protein</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;pdb/protein_H.pdb&quot;</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/core/universe.py:356,</span> in <span class="ni">Universe.__init__</span><span class="nt">(self, topology, all_coordinates, format, topology_format, transformations, guess_bonds, vdwradii, fudge_factor, lower_bound, in_memory, in_memory_step, *coordinates, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">354</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="n">Topology</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">topology</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">355</span>     <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">_check_file_like</span><span class="p">(</span><span class="n">topology</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">356</span>     <span class="n">topology</span> <span class="o">=</span> <span class="n">_topology_from_file_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span>                                         <span class="n">topology_format</span><span class="o">=</span><span class="n">topology_format</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span>                                         <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">360</span> <span class="k">if</span> <span class="n">topology</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">361</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_topology</span> <span class="o">=</span> <span class="n">topology</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/core/universe.py:118,</span> in <span class="ni">_topology_from_file_like</span><span class="nt">(topology_file, topology_format, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span>     <span class="c1"># There are 2 kinds of errors that might be raised here:</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>     <span class="c1"># one because the file isn&#39;t present</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span>     <span class="c1"># or the permissions are bad, second when the parser fails</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span>     <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>         <span class="n">errno</span><span class="o">.</span><span class="n">errorcode</span><span class="p">[</span><span class="n">err</span><span class="o">.</span><span class="n">errno</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ENOENT&#39;</span><span class="p">,</span> <span class="s1">&#39;EACCES&#39;</span><span class="p">]):</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span>         <span class="c1"># Runs if the error is propagated due to no permission / file not found</span>
<span class="ne">--&gt; </span><span class="mi">118</span>         <span class="k">raise</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">    </span><span class="mi">119</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">120</span>         <span class="c1"># Runs when the parser fails</span>
<span class="g g-Whitespace">    </span><span class="mi">121</span>         <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;Failed to load from the topology file </span><span class="si">{0}</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">122</span>                         <span class="s2">&quot; with parser </span><span class="si">{1}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">123</span>                         <span class="s2">&quot;Error: </span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">topology_file</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">err</span><span class="p">))</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/core/universe.py:110,</span> in <span class="ni">_topology_from_file_like</span><span class="nt">(topology_file, topology_format, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span>     <span class="k">with</span> <span class="n">parser</span><span class="p">(</span><span class="n">topology_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">110</span>         <span class="n">topology</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span>     <span class="c1"># There are 2 kinds of errors that might be raised here:</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>     <span class="c1"># one because the file isn&#39;t present</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span>     <span class="c1"># or the permissions are bad, second when the parser fails</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span>     <span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>         <span class="n">errno</span><span class="o">.</span><span class="n">errorcode</span><span class="p">[</span><span class="n">err</span><span class="o">.</span><span class="n">errno</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ENOENT&#39;</span><span class="p">,</span> <span class="s1">&#39;EACCES&#39;</span><span class="p">]):</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span>         <span class="c1"># Runs if the error is propagated due to no permission / file not found</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/topology/PDBParser.py:210,</span> in <span class="ni">PDBParser.parse</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">203</span> <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">204</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Parse atom information from PDB file</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">206</span><span class="sd">     Returns</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span><span class="sd">     -------</span>
<span class="g g-Whitespace">    </span><span class="mi">208</span><span class="sd">     MDAnalysis Topology object</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">210</span>     <span class="n">top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parseatoms</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span>     <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">213</span>         <span class="n">bonds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parsebonds</span><span class="p">(</span><span class="n">top</span><span class="o">.</span><span class="n">ids</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/topology/PDBParser.py:247,</span> in <span class="ni">PDBParser._parseatoms</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">245</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wrapped_serials</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># did serials go over 100k?</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span> <span class="n">last_wrapped_serial</span> <span class="o">=</span> <span class="mi">100000</span>  <span class="c1"># if serials wrap, start from here</span>
<span class="ne">--&gt; </span><span class="mi">247</span> <span class="k">with</span> <span class="n">util</span><span class="o">.</span><span class="n">openany</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span>     <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span>         <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># Remove extra spaces</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/contextlib.py:137,</span> in <span class="ni">_GeneratorContextManager.__enter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">135</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">137</span>     <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span> <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span>     <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;generator didn&#39;t yield&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/util.py:318,</span> in <span class="ni">openany</span><span class="nt">(datasource, mode, reset)</span>
<span class="g g-Whitespace">    </span><span class="mi">274</span> <span class="nd">@contextmanager</span>
<span class="g g-Whitespace">    </span><span class="mi">275</span> <span class="k">def</span> <span class="nf">openany</span><span class="p">(</span><span class="n">datasource</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rt&#39;</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Context manager for :func:`anyopen`.</span>
<span class="g g-Whitespace">    </span><span class="mi">277</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">278</span><span class="sd">     Open the `datasource` and close it when the context of the :keyword:`with`</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span><span class="sd">     :func:`anyopen`</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">318</span>     <span class="n">stream</span> <span class="o">=</span> <span class="n">anyopen</span><span class="p">(</span><span class="n">datasource</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="n">reset</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span>     <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">320</span>         <span class="k">yield</span> <span class="n">stream</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/util.py:398,</span> in <span class="ni">anyopen</span><span class="nt">(datasource, mode, reset)</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span> <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;bz2&#39;</span><span class="p">,</span> <span class="s1">&#39;gz&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>  <span class="c1"># file == &#39;&#39; should be last</span>
<span class="g g-Whitespace">    </span><span class="mi">397</span>     <span class="n">openfunc</span> <span class="o">=</span> <span class="n">read_handlers</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">398</span>     <span class="n">stream</span> <span class="o">=</span> <span class="n">_get_stream</span><span class="p">(</span><span class="n">datasource</span><span class="p">,</span> <span class="n">openfunc</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">399</span>     <span class="k">if</span> <span class="n">stream</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">400</span>         <span class="k">break</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/util.py:440,</span> in <span class="ni">_get_stream</span><span class="nt">(filename, openfunction, mode)</span>
<span class="g g-Whitespace">    </span><span class="mi">435</span> <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">436</span>     <span class="c1"># An exception might be raised due to two reasons, first the openfunction is unable to open the file, in this</span>
<span class="g g-Whitespace">    </span><span class="mi">437</span>     <span class="c1"># case we have to ignore the error and return None. Second is when openfunction can&#39;t open the file because</span>
<span class="g g-Whitespace">    </span><span class="mi">438</span>     <span class="c1"># either the file isn&#39;t there or the permissions don&#39;t allow access.</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span>     <span class="k">if</span> <span class="n">errno</span><span class="o">.</span><span class="n">errorcode</span><span class="p">[</span><span class="n">err</span><span class="o">.</span><span class="n">errno</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ENOENT&#39;</span><span class="p">,</span> <span class="s1">&#39;EACCES&#39;</span><span class="p">]:</span>
<span class="ne">--&gt; </span><span class="mi">440</span>         <span class="k">raise</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">    </span><span class="mi">441</span>     <span class="k">return</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">442</span> <span class="k">if</span> <span class="n">mode</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">443</span>     <span class="c1"># additional check for reading (eg can we uncompress) --- is this needed?</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/util.py:434,</span> in <span class="ni">_get_stream</span><span class="nt">(filename, openfunction, mode)</span>
<span class="g g-Whitespace">    </span><span class="mi">432</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;Return open stream if *filename* can be opened with *openfunction* or else ``None``.&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">433</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">434</span>     <span class="n">stream</span> <span class="o">=</span> <span class="n">openfunction</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">435</span> <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">436</span>     <span class="c1"># An exception might be raised due to two reasons, first the openfunction is unable to open the file, in this</span>
<span class="g g-Whitespace">    </span><span class="mi">437</span>     <span class="c1"># case we have to ignore the error and return None. Second is when openfunction can&#39;t open the file because</span>
<span class="g g-Whitespace">    </span><span class="mi">438</span>     <span class="c1"># either the file isn&#39;t there or the permissions don&#39;t allow access.</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span>     <span class="k">if</span> <span class="n">errno</span><span class="o">.</span><span class="n">errorcode</span><span class="p">[</span><span class="n">err</span><span class="o">.</span><span class="n">errno</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ENOENT&#39;</span><span class="p">,</span> <span class="s1">&#39;EACCES&#39;</span><span class="p">]:</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/picklable_file_io.py:502,</span> in <span class="ni">bz2_pickle_open</span><span class="nt">(name, mode)</span>
<span class="g g-Whitespace">    </span><span class="mi">499</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only read mode (&#39;r&#39;, &#39;rt&#39;, &#39;rb&#39;) &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">500</span>                      <span class="s2">&quot;files can be pickled.&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">501</span> <span class="n">bz_mode</span> <span class="o">=</span> <span class="n">mode</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">502</span> <span class="n">binary_file</span> <span class="o">=</span> <span class="n">BZ2Picklable</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bz_mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">503</span> <span class="k">if</span> <span class="s2">&quot;t&quot;</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">504</span>     <span class="k">return</span> <span class="n">TextIOPicklable</span><span class="p">(</span><span class="n">binary_file</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/lib/picklable_file_io.py:283,</span> in <span class="ni">BZ2Picklable.__init__</span><span class="nt">(self, name, mode)</span>
<span class="g g-Whitespace">    </span><span class="mi">281</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rb&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">282</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_bz_mode</span> <span class="o">=</span> <span class="n">mode</span>
<span class="ne">--&gt; </span><span class="mi">283</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/envs/biochemist-python/lib/python3.11/bz2.py:81,</span> in <span class="ni">BZ2File.__init__</span><span class="nt">(self, filename, mode, compresslevel)</span>
<span class="g g-Whitespace">     </span><span class="mi">78</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid mode: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mode</span><span class="p">,))</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">)):</span>
<span class="ne">---&gt; </span><span class="mi">81</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_fp</span> <span class="o">=</span> <span class="n">_builtin_open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">82</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_closefp</span> <span class="o">=</span> <span class="kc">True</span>
<span class="g g-Whitespace">     </span><span class="mi">83</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">mode_code</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;pdb/protein_H.pdb&#39;
</pre></div>
</div>
</div>
</div>
<p>Adding hydrogens to our ligand is a little bit more difficult.
We can’t just use PDB2PQR in this case.
Our ligand might not have bond lengths such that the proper bond orders are always recognized, so we will want to make sure that we have a proper reference.</p>
<p>We will use the ideal ligand we downloaded as a reference and use a small molecule manipulation software called <a class="reference internal" href="#"><span class="xref myst">RDKit</span></a> to match bond orders and add hydrogens.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>

<span class="kn">from</span> <span class="nn">rdkit.Chem.AllChem</span> <span class="kn">import</span> <span class="n">AssignBondOrdersFromTemplate</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromMol2File</span><span class="p">(</span><span class="s2">&quot;ligands/13U_ideal.mol2&quot;</span><span class="p">)</span>
<span class="n">pdb_ligand</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromPDBFile</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/ligand_A.pdb&quot;</span><span class="p">)</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">RemoveAllHs</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ligand</span> <span class="o">=</span> <span class="n">AssignBondOrdersFromTemplate</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">pdb_ligand</span><span class="p">)</span>

<span class="c1"># Write the ligand to an SDF file</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">MolToMolFile</span><span class="p">(</span><span class="n">ligand</span><span class="p">,</span> <span class="s2">&quot;pdb/ligand.sdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we need to make sure this structure has hydrogens for our analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openbabel</span> <span class="kn">import</span> <span class="n">pybel</span>

<span class="c1"># Use pybel to read the SDF, add hydrogens, and save as PDB</span>
<span class="n">mol</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">pybel</span><span class="o">.</span><span class="n">readfile</span><span class="p">(</span><span class="s2">&quot;sdf&quot;</span><span class="p">,</span> <span class="s2">&quot;pdb/ligand.sdf&quot;</span><span class="p">))</span>
<span class="n">mol</span><span class="o">.</span><span class="n">addh</span><span class="p">()</span>  <span class="c1"># Add hydrogens</span>
<span class="n">mol</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;pdb/ligand_h.pdb&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualizing-the-binding-site">
<h3>Visualizing the Binding Site<a class="headerlink" href="#visualizing-the-binding-site" title="Link to this heading">#</a></h3>
<p>Now that we have our files with hydrogens prepared, we can make a map of the binding site.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">prolif</span> <span class="k">as</span> <span class="nn">plf</span>

<span class="n">protein_h</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/protein_h.pdb&quot;</span><span class="p">)</span>
<span class="n">ligand_h</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/ligand_h.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein_mol</span> <span class="o">=</span> <span class="n">plf</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_mda</span><span class="p">(</span><span class="n">protein_h</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ligand_mol</span> <span class="o">=</span> <span class="n">plf</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_mda</span><span class="p">(</span><span class="n">ligand_h</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span> <span class="o">=</span> <span class="n">plf</span><span class="o">.</span><span class="n">Fingerprint</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lig_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">ligand_mol</span> <span class="p">]</span> 

<span class="n">interactions</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">run_from_iterable</span><span class="p">(</span><span class="n">lig_list</span><span class="p">,</span> <span class="n">protein_mol</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">plot_lignetwork</span><span class="p">(</span><span class="n">lig_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="EC_class_ligands_search.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Enzyme Commission Class with Ligands</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-the-structure">Downloading the Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-the-structure">View the structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#making-a-map-of-ligand-contacts">Making a Map of Ligand Contacts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structure-preparation">Structure Preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-binding-site">Visualizing the Binding Site</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Molecular Sciences Software Institute
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>