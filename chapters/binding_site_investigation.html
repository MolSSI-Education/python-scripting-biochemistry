
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Visualizing the Binding Site of a Protein-Ligand Complex &#8212; Python Data and Scripting for Biochemists and Molecular Biologists</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=0905f21a" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-FHKVGE8HKZ"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-FHKVGE8HKZ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-FHKVGE8HKZ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/binding_site_investigation';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Enzyme Commission Class with Ligands" href="EC_class_ligands_search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="setup.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/molssi_main_logo.png" class="logo__image only-light" alt="Python Data and Scripting for Biochemists and Molecular Biologists - Home"/>
    <script>document.write(`<img src="../_static/molssi_main_logo_inverted_white.png" class="logo__image only-dark" alt="Python Data and Scripting for Biochemists and Molecular Biologists - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="workshop_schedule.html">Workshop Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="File_Parsing.html">File Parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Processing_Multiple_Files_and_Writing_Files.html">Processing Multiple Files and Writing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Working_with_Pandas.html">Working with Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Linear_Regression.html">Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="Creating_Plots_in_Jupyter_Notebooks.html">Creating Plots in Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinear_regression_part_1.html">Nonlinear Regression Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinear_regression_part_2.html">Nonlinear Regression Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="biopython_mmcif.html">Analyzing MMCIF Files using Biopython</a></li>
<li class="toctree-l1"><a class="reference internal" href="rcsb_api.html">Retrieving Information from the PDB using the Web API</a></li>
<li class="toctree-l1"><a class="reference internal" href="MolVis_with_iCN3D.html">Molecular Visualization with iCN3D</a></li>



<li class="toctree-l1"><a class="reference internal" href="EC_class_ligands_search.html">Enzyme Commission Class with Ligands</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Visualizing the Binding Site of a Protein-Ligand Complex</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/binding_site_investigation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Visualizing the Binding Site of a Protein-Ligand Complex</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-the-structure">Downloading the Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-the-structure">View the structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#making-a-map-of-ligand-contacts">Making a Map of Ligand Contacts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structure-preparation">Structure Preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-binding-site">Visualizing the Binding Site</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="visualizing-the-binding-site-of-a-protein-ligand-complex">
<h1>Visualizing the Binding Site of a Protein-Ligand Complex<a class="headerlink" href="#visualizing-the-binding-site-of-a-protein-ligand-complex" title="Link to this heading">#</a></h1>
<p>Learning Objectives</p>
<ul class="simple">
<li><p>Use NGLView to view the 3D structure of our protein and ligand.</p></li>
<li><p>Prepare molecule structures using <a class="reference external" href="https://pdb2pqr.readthedocs.io/en/latest/">PDQ2PQR</a> and <a class="reference external" href="https://www.rdkit.org/">RDKit</a>.</p></li>
<li><p>Analyze the interactions of the protein in the binding site using a 2D map and <a class="reference external" href="https://prolif.readthedocs.io/en/stable/">ProLIF</a>.</p></li>
</ul>
<p>Before we begin our docking calculations, we will likely want to investigate the binding site of our ligand of interest.
We will want to look at the binding pocket and the interactions of the ligand with the protein residues.
For the rest of our studies, we will choose the ligand <a class="reference external" href="https://www.rcsb.org/ligand/13U"><code class="docutils literal notranslate"><span class="pre">13U</span></code></a>.
A trypsin structure where this ligand is bound is 2ZQ2.</p>
<section id="downloading-the-structure">
<h2>Downloading the Structure<a class="headerlink" href="#downloading-the-structure" title="Link to this heading">#</a></h2>
<p>First we will need to download our protein structure. We will download <a class="reference external" href="https://www.rcsb.org/structure/2zq2">2ZQ2</a>, which is a trypsin structure with our ligand of interest bound.</p>
<p>We will use a similar strategy to our last notebook for getting the file.
We will use Python’s request module and a URL from the Protein Data Bank.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span> <span class="c1"># for making directories</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="c1"># make a directory for pdb files</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">pdb_id</span> <span class="o">=</span> <span class="s2">&quot;2zq2&quot;</span> <span class="c1"># trypsin PDB file with ligand bound</span>

<span class="n">pdb_request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;https://files.rcsb.org/download/</span><span class="si">{</span><span class="n">pdb_id</span><span class="si">}</span><span class="s2">.pdb&quot;</span><span class="p">)</span>
<span class="n">pdb_request</span><span class="o">.</span><span class="n">status_code</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>200
</pre></div>
</div>
</div>
</div>
<p>After downloading, we will write the text to a file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/</span><span class="si">{</span><span class="n">pdb_id</span><span class="si">}</span><span class="s2">.pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pdb_request</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="view-the-structure">
<h2>View the structure<a class="headerlink" href="#view-the-structure" title="Link to this heading">#</a></h2>
<p>Before we start to really work with our molecule, let’s investigate the structure.
We will use a library called MDAnalysis to first process our PDB, then visualize it with a library called NGLView.
In the cell below, we define some convenience functions for NGLView.
These are functions that the tutorial writers wrote for our protein ligand system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="k">def</span> <span class="nf">rotate_view</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">radians</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span> <span class="n">radians</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
    <span class="n">view</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">spin</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">*</span><span class="n">radians</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">spin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">*</span><span class="n">radians</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">spin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="o">*</span><span class="n">radians</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">view_binding_site</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">ligand</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;View binding site of 13U to trypsin.</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    protein: mda.Universe</span>
<span class="sd">        The protein as an MDAnalysis universe.</span>

<span class="sd">    ligand: mda.Universe</span>
<span class="sd">        The ligand as an MDAnalysis universe.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">view</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">show_mdanalysis</span><span class="p">(</span><span class="n">protein</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">clear_representations</span><span class="p">()</span>
    <span class="n">view</span><span class="o">.</span><span class="n">add_representation</span><span class="p">(</span><span class="s2">&quot;surface&quot;</span><span class="p">,</span> <span class="n">colorScheme</span><span class="o">=</span><span class="s2">&quot;hydrophobicity&quot;</span><span class="p">)</span>
    <span class="n">lig_view</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">add_component</span><span class="p">(</span><span class="n">ligand</span><span class="p">)</span>
    <span class="n">lig_view</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
    <span class="n">rotate_view</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">view</span>
    
</pre></div>
</div>
</div>
</div>
<p>MDAnalysis is a popular tool for processing molecular dynamics trajectories and other molecular structures.
The central object in MDAnalysis is called a “Universe”. In MDAnalysis terms, a Universe represents a molecular
system. We can load an MDAnalysis universe from a PDB file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="kn">import</span> <span class="nn">nglview</span> <span class="k">as</span> <span class="nn">nv</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/</span><span class="si">{</span><span class="n">pdb_id</span><span class="si">}</span><span class="s2">.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "21564f47e4294fb98db5efa380fbf193"}</script></div>
</div>
<p>Text here about NGLView</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">show_mdanalysis</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "9759dbe2ce4c417f961659645e93d37a"}</script></div>
</div>
<p>This view looks a bit messy. MDAnalysis has a human readable <a class="reference external" href="https://docs.mdanalysis.org/stable/documentation_pages/selections.html">selection syntax</a>
that allows us to isolate parts of our structure. We will take our MDAnalysis Universe (the variable <code class="docutils literal notranslate"><span class="pre">u</span></code>) and use the <code class="docutils literal notranslate"><span class="pre">select_atoms</span></code> function.
Inside this function, we will fill in what we want to select.</p>
<p>We will create separate variables for the protein and ligand. We can select all protein residues in MDAnalysis using the word “protein” in the <code class="docutils literal notranslate"><span class="pre">select_atoms</span></code> function. Then, we will select our ligand using <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">13U</span></code>. This corresponds to the residue name in the PDB we downloaded.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>
<span class="n">ligand</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;resname 13U&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We will use our helper function, defined above, to look at how the ligand is bound to the protein.
This helper function will use NGLView, like we did previously, but adds coloring the surface by hydrophobicity.
It also zooms in on the ligand.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_binding_site</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">ligand</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "2a3b5861a13c413e96e408e3fefd6bc2"}</script></div>
</div>
<p>Upon viewing this structure, you will notice that our ligand seems to appear twice.
If you open the PDB file to investigate, you will see the following in the ligand section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HETATM</span> <span class="mi">1673</span>  <span class="n">C14A13U</span> <span class="n">A</span> <span class="mi">501</span>      <span class="mf">18.144</span>  <span class="o">-</span><span class="mf">9.216</span>  <span class="mf">12.088</span>  <span class="mf">0.61</span> <span class="mf">24.22</span>           <span class="n">C</span>  
<span class="n">ANISOU</span> <span class="mi">1673</span>  <span class="n">C14A13U</span> <span class="n">A</span> <span class="mi">501</span>     <span class="mi">1755</span>   <span class="mi">4793</span>   <span class="mi">2654</span>   <span class="mi">1752</span>    <span class="mi">148</span>   <span class="mi">1233</span>       <span class="n">C</span>  
<span class="n">HETATM</span> <span class="mi">1674</span>  <span class="n">C14B13U</span> <span class="n">A</span> <span class="mi">501</span>      <span class="mf">18.147</span>  <span class="o">-</span><span class="mf">8.840</span>  <span class="mf">11.672</span>  <span class="mf">0.39</span> <span class="mf">24.46</span>           <span class="n">C</span>  
<span class="n">ANISOU</span> <span class="mi">1674</span>  <span class="n">C14B13U</span> <span class="n">A</span> <span class="mi">501</span>     <span class="mi">2583</span>   <span class="mi">4283</span>   <span class="mi">2430</span>   <span class="mi">1765</span>    <span class="mi">353</span>   <span class="mi">1279</span>       <span class="n">C</span>  
<span class="n">HETATM</span> <span class="mi">1675</span>  <span class="n">O32A13U</span> <span class="n">A</span> <span class="mi">501</span>      <span class="mf">18.209</span>  <span class="o">-</span><span class="mf">8.355</span>  <span class="mf">11.186</span>  <span class="mf">0.61</span> <span class="mf">24.38</span>           <span class="n">O</span>  
<span class="n">ANISOU</span> <span class="mi">1675</span>  <span class="n">O32A13U</span> <span class="n">A</span> <span class="mi">501</span>     <span class="mi">2354</span>   <span class="mi">5394</span>   <span class="mi">1514</span>   <span class="mi">2217</span>    <span class="mi">238</span>    <span class="mi">919</span>       <span class="n">O</span>
</pre></div>
</div>
<p>This PDB structure provides <strong>alternate locations</strong> for each ligand atom. In excerpt above, you will see C14A13U and C14B13U. These are alternate locations of the same atom.
By checking the <a class="reference external" href="https://docs.mdanalysis.org/stable/documentation_pages/selections.html">documentation page</a> for MDAnalysis selections, we can see that MDAnalysis is prepared for this scenario. We will want to use the <code class="docutils literal notranslate"><span class="pre">altloc</span></code> keyword. This keyword is described as:</p>
<blockquote>
<div><p>altLoc alternative-location</p>
</div></blockquote>
<blockquote>
<div><p>a selection for atoms where alternative locations are available, which is often the case with high-resolution crystal structures e.g. resid 4 and resname ALA and altLoc B selects only the atoms of ALA-4 that have an altLoc B record.</p>
</div></blockquote>
<p>We can alter our MDAnalysis selection syntax to isolate our ligands of interest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>
<span class="n">ligand_A</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;resname 13U and altLoc A&quot;</span><span class="p">)</span>
<span class="n">ligand_B</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;resname 13U and altLoc B&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we can use our viewing function to see the location of each ligand.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_binding_site</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">ligand_A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "21480dac6468402a832fa902ada3c14d"}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_binding_site</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">ligand_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "b5997e4def5440fea76d9710b0a613f5"}</script></div>
</div>
<p>When we inspect the ligand in the binding site, we notice a few things.
First, the binding site has a large hydrophobic area on the surface.
If you zoom in on the binding pocket, you’ll also see that the benzene ring and amine groups are inside.</p>
</section>
<section id="making-a-map-of-ligand-contacts">
<h2>Making a Map of Ligand Contacts<a class="headerlink" href="#making-a-map-of-ligand-contacts" title="Link to this heading">#</a></h2>
<p>To get an even better idea of how our ligand is binding to the protein, we might choose to make a 2D map of ligand contacts with protein residues.
In this analysis, we’ll want to know how the ligand is interacting with the protein residues including if it is making hydrogen bonds, Van Der Waals interactions, etc.</p>
<p>We will use a library called <a class="reference external" href="https://prolif.readthedocs.io/en/stable/">ProLIF</a> for this analysis. ProLIF is short for “Protein-Ligand Interaction Fingerprints” and it “ is a tool designed to generate interaction fingerprints for complexes made of ligands, protein, DNA or RNA molecules extracted from molecular dynamics trajectories, docking simulations and experimental structures.” (quote taken from ProLIF docs).</p>
<p>Before we use ProLIF, we first have to make sure our ligand and protein file are prepared properly.
Hydrogens are absent in most PDB files because they are not well resolved by methods like X-Ray crystallography.
We’ll need to add them back in in order to complete our analysis of the binding site.</p>
<p>This process can actually be quite involved, as we’ll see below.</p>
<p>We will start by saving new PDBs of our selections from MDAnalysis.
Then, we will add hydrogens.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/protein_</span><span class="si">{</span><span class="n">pdb_id</span><span class="si">}</span><span class="s2">.pdb&quot;</span><span class="p">)</span>
<span class="n">ligand_A</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/ligand_A.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda/envs/biochemist-python/lib/python3.11/site-packages/MDAnalysis/coordinates/PDB.py:1153: UserWarning: Found no information for attr: &#39;formalcharges&#39; Using default value of &#39;0&#39;
  warnings.warn(&quot;Found no information for attr: &#39;{}&#39;&quot;
</pre></div>
</div>
</div>
</div>
<section id="structure-preparation">
<h3>Structure Preparation<a class="headerlink" href="#structure-preparation" title="Link to this heading">#</a></h3>
<p>Before we run the analysis, we need to make sure our protein and ligand have hydrogen atoms.
We will do this first for the protein.</p>
<p>We will use a specialized program called PDB2PQR that is made for working with biomolecules like proteins.
The advantage of using PDB2PQR is that it will check our protein for missing atoms and multiple occupancy in the protein.</p>
<p>We will use the command-line interface of this program. This means that you would usually type the command below into your terminal
You can run command line commands in the Jupyter notebook by putting a <code class="docutils literal notranslate"><span class="pre">!</span></code> in front of the command.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>pdb2pqr<span class="w"> </span>--pdb-output<span class="o">=</span>pdb/protein_h.pdb<span class="w"> </span>--pH<span class="o">=</span><span class="m">7</span>.4<span class="w"> </span>pdb/protein_2zq2.pdb<span class="w"> </span>protein.pqr
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:PDB2PQR v3.6.2: biomolecular structure conversion software.
INFO:Please cite:  Jurrus E, et al.  Improvements to the APBS biomolecular solvation software suite.  Protein Sci 27 112-128 (2018).
INFO:Please cite:  Dolinsky TJ, et al.  PDB2PQR: expanding and upgrading automated preparation of biomolecular structures for molecular simulations. Nucleic Acids Res 35 W522-W525 (2007).
INFO:Checking and transforming input arguments.
INFO:Loading topology files.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:Loading molecule: pdb/protein_2zq2.pdb
ERROR:Error parsing line: invalid literal for int() with base 10: &#39;&#39;
ERROR:&lt;REMARK     2&gt;
ERROR:Truncating remaining errors for record type:REMARK
WARNING:Warning: pdb/protein_2zq2.pdb is a non-standard PDB file.

ERROR:[&#39;REMARK&#39;]
INFO:Setting up molecule.
INFO:Created biomolecule object with 223 residues and 1625 atoms.
WARNING:Multiple occupancies found: N in SER A 61.
WARNING:Multiple occupancies found: CA in SER A 61.
WARNING:Multiple occupancies found: C in SER A 61.
WARNING:Multiple occupancies found: O in SER A 61.
WARNING:Multiple occupancies found: CB in SER A 61.
WARNING:Multiple occupancies found: OG in SER A 61.
WARNING:Multiple occupancies found in SER A 61. At least one of the instances is being ignored.
WARNING:Multiple occupancies found: N in SER A 113.
WARNING:Multiple occupancies found: CA in SER A 113.
WARNING:Multiple occupancies found: C in SER A 113.
WARNING:Multiple occupancies found: O in SER A 113.
WARNING:Multiple occupancies found: CB in SER A 113.
WARNING:Multiple occupancies found: OG in SER A 113.
WARNING:Multiple occupancies found in SER A 113. At least one of the instances is being ignored.
WARNING:Multiple occupancies found: N in SER A 122.
WARNING:Multiple occupancies found: CA in SER A 122.
WARNING:Multiple occupancies found: C in SER A 122.
WARNING:Multiple occupancies found: O in SER A 122.
WARNING:Multiple occupancies found: CB in SER A 122.
WARNING:Multiple occupancies found: OG in SER A 122.
WARNING:Multiple occupancies found in SER A 122. At least one of the instances is being ignored.
WARNING:Multiple occupancies found: N in SER A 167.
WARNING:Multiple occupancies found: CA in SER A 167.
WARNING:Multiple occupancies found: C in SER A 167.
WARNING:Multiple occupancies found: O in SER A 167.
WARNING:Multiple occupancies found: CB in SER A 167.
WARNING:Multiple occupancies found: OG in SER A 167.
WARNING:Multiple occupancies found in SER A 167. At least one of the instances is being ignored.
WARNING:Multiple occupancies found: N in SER A 170.
WARNING:Multiple occupancies found: CA in SER A 170.
WARNING:Multiple occupancies found: C in SER A 170.
WARNING:Multiple occupancies found: O in SER A 170.
WARNING:Multiple occupancies found: CB in SER A 170.
WARNING:Multiple occupancies found: OG in SER A 170.
WARNING:Multiple occupancies found in SER A 170. At least one of the instances is being ignored.
WARNING:Multiple occupancies found: N in SER A 236.
WARNING:Multiple occupancies found: CA in SER A 236.
WARNING:Multiple occupancies found: C in SER A 236.
WARNING:Multiple occupancies found: O in SER A 236.
WARNING:Multiple occupancies found: CB in SER A 236.
WARNING:Multiple occupancies found: OG in SER A 236.
WARNING:Multiple occupancies found in SER A 236. At least one of the instances is being ignored.
WARNING:Multiple occupancies found: N in GLN A 240.
WARNING:Multiple occupancies found: CA in GLN A 240.
WARNING:Multiple occupancies found: C in GLN A 240.
WARNING:Multiple occupancies found: O in GLN A 240.
WARNING:Multiple occupancies found: CB in GLN A 240.
WARNING:Multiple occupancies found: CG in GLN A 240.
WARNING:Multiple occupancies found: CD in GLN A 240.
WARNING:Multiple occupancies found: OE1 in GLN A 240.
WARNING:Multiple occupancies found: NE2 in GLN A 240.
WARNING:Multiple occupancies found in GLN A 240. At least one of the instances is being ignored.
INFO:Setting termini states for biomolecule chains.
INFO:Loading forcefield.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:Loading hydrogen topology definitions.
WARNING:Missing atom CG in residue LYS A 222
WARNING:Missing atom CD in residue LYS A 222
WARNING:Missing atom CE in residue LYS A 222
WARNING:Missing atom NZ in residue LYS A 222
WARNING:Missing atom CG in residue LYS A 222
WARNING:Missing atom CD in residue LYS A 222
WARNING:Missing atom CE in residue LYS A 222
WARNING:Missing atom NZ in residue LYS A 222
INFO:Attempting to repair 4 missing atoms in biomolecule.
WARNING:Missing atom CG in residue LYS A 222
WARNING:Missing atom CD in residue LYS A 222
WARNING:Missing atom CE in residue LYS A 222
WARNING:Missing atom NZ in residue LYS A 222
INFO:Added atom CG to residue LYS A 222 at coordinates 30.628, -3.449, -0.010
INFO:Added atom CD to residue LYS A 222 at coordinates 32.074, -3.541, -0.453
INFO:Added atom CE to residue LYS A 222 at coordinates 32.755, -2.198, -0.512
INFO:Added atom NZ to residue LYS A 222 at coordinates 34.167, -2.339, -0.950
INFO:Updating disulfide bridges.
INFO:Debumping biomolecule.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:Adding hydrogens to biomolecule.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:Debumping biomolecule (again).
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:Optimizing hydrogen bonds
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:Applying force field to biomolecule states.
INFO:Regenerating headers.
INFO:Regenerating PDB lines.
WARNING:Ignoring 390 header lines in output.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING:Ignoring 390 header lines in output.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;pdb/protein_h.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Adding hydrogens to our ligand is a little bit more difficult.
We can’t just use PDB2PQR in this case.
Our ligand might not have bond lengths such that the proper bond orders are always recognized, so we will want to make sure that we have a proper reference.</p>
<p>We will use the ideal ligand we downloaded as a reference and use a small molecule manipulation software called <a class="reference internal" href="#"><span class="xref myst">RDKit</span></a> to match bond orders and add hydrogens.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>

<span class="kn">from</span> <span class="nn">rdkit.Chem.AllChem</span> <span class="kn">import</span> <span class="n">AssignBondOrdersFromTemplate</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromMol2File</span><span class="p">(</span><span class="s2">&quot;ligands/13U_ideal.mol2&quot;</span><span class="p">)</span>
<span class="n">pdb_ligand</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromPDBFile</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/ligand_A.pdb&quot;</span><span class="p">)</span>

<span class="n">template</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">RemoveAllHs</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OSError</span><span class="g g-Whitespace">                                   </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">from</span> <span class="nn">rdkit.Chem.AllChem</span> <span class="kn">import</span> <span class="n">AssignBondOrdersFromTemplate</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">template</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromMol2File</span><span class="p">(</span><span class="s2">&quot;ligands/13U_ideal.mol2&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">pdb_ligand</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromPDBFile</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/ligand_A.pdb&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">template</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">RemoveAllHs</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>

<span class="ne">OSError</span>: Bad input file ligands/13U_ideal.mol2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ligand</span> <span class="o">=</span> <span class="n">AssignBondOrdersFromTemplate</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">pdb_ligand</span><span class="p">)</span>

<span class="c1"># Write the ligand to an SDF file</span>
<span class="n">Chem</span><span class="o">.</span><span class="n">MolToMolFile</span><span class="p">(</span><span class="n">ligand</span><span class="p">,</span> <span class="s2">&quot;pdb/ligand.sdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[17:30:37] WARNING: More than one matching pattern found - picking one
</pre></div>
</div>
</div>
</div>
<p>Now, we need to make sure this structure has hydrogens for our analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openbabel</span> <span class="kn">import</span> <span class="n">pybel</span>

<span class="c1"># Use pybel to read the SDF, add hydrogens, and save as PDB</span>
<span class="n">mol</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">pybel</span><span class="o">.</span><span class="n">readfile</span><span class="p">(</span><span class="s2">&quot;sdf&quot;</span><span class="p">,</span> <span class="s2">&quot;pdb/ligand.sdf&quot;</span><span class="p">))</span>
<span class="n">mol</span><span class="o">.</span><span class="n">addh</span><span class="p">()</span>  <span class="c1"># Add hydrogens</span>
<span class="n">mol</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;pdb/ligand_h.pdb&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualizing-the-binding-site">
<h3>Visualizing the Binding Site<a class="headerlink" href="#visualizing-the-binding-site" title="Link to this heading">#</a></h3>
<p>Now that we have our files with hydrogens prepared, we can make a map of the binding site.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">prolif</span> <span class="k">as</span> <span class="nn">plf</span>

<span class="n">protein_h</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/protein_h.pdb&quot;</span><span class="p">)</span>
<span class="n">ligand_h</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pdb/ligand_h.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein_mol</span> <span class="o">=</span> <span class="n">plf</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_mda</span><span class="p">(</span><span class="n">protein_h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/janash/miniconda3/envs/iqb-2024/lib/python3.11/site-packages/MDAnalysis/converters/RDKit.py:473: UserWarning: No `bonds` attribute in this AtomGroup. Guessing bonds based on atoms coordinates
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ligand_mol</span> <span class="o">=</span> <span class="n">plf</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_mda</span><span class="p">(</span><span class="n">ligand_h</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span> <span class="o">=</span> <span class="n">plf</span><span class="o">.</span><span class="n">Fingerprint</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lig_list</span> <span class="o">=</span> <span class="p">[</span> <span class="n">ligand_mol</span> <span class="p">]</span> 

<span class="n">interactions</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">run_from_iterable</span><span class="p">(</span><span class="n">lig_list</span><span class="p">,</span> <span class="n">protein_mol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "dd2bb2945a984100ae6a949c99718578", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">plot_lignetwork</span><span class="p">(</span><span class="n">lig_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">view</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><iframe width="100%" height="590px" frameborder="0" srcdoc="
        &lt;html&gt;
        &lt;head&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;https://unpkg.com/vis-network@9.0.4/dist/vis-network.min.js&quot;&gt;&lt;/script&gt;
        &lt;link href=&quot;https://unpkg.com/vis-network@9.0.4/dist/dist/vis-network.min.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;
        &lt;style type=&quot;text/css&quot;&gt;
            body {
                padding: 0;
                margin: 0;
                background: #fff;
            }
            .legend-btn.residues.disabled {
                background: #b4b4b4 !important;
                color: #555 !important;
            }
            .legend-btn.interactions.disabled {
                border-color: #b4b4b4 !important;
                color: #555 !important;
            }
        &lt;/style&gt;
        &lt;/head&gt;
        &lt;body&gt;
        &lt;div id=&quot;mynetwork&quot;&gt;&lt;/div&gt;
        &lt;div id=&quot;networklegend&quot;&gt;&lt;/div&gt;
        &lt;script type=&quot;text/javascript&quot;&gt;
            
        var ifp, legend, nodes, edges, legend_buttons;
        function drawGraph(_id, nodes, edges, options) {
            var container = document.getElementById(_id);
            nodes = new vis.DataSet(nodes);
            edges = new vis.DataSet(edges);
            var data = {nodes: nodes, edges: edges};
            var network = new vis.Network(container, data, options);
            network.on(&quot;stabilizationIterationsDone&quot;, function () {
                network.setOptions( { physics: false } );
            });
            return network;
        }
        nodes = [{&quot;id&quot;: &quot;ASN97.A&quot;, &quot;label&quot;: &quot;ASN97.A&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Polar&quot;}, {&quot;id&quot;: &quot;ASP189.A&quot;, &quot;label&quot;: &quot;ASP189.A&quot;, &quot;color&quot;: &quot;#e35959&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Acidic&quot;}, {&quot;id&quot;: &quot;GLN175.A&quot;, &quot;label&quot;: &quot;GLN175.A&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Polar&quot;}, {&quot;id&quot;: &quot;GLN192.A&quot;, &quot;label&quot;: &quot;GLN192.A&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Polar&quot;}, {&quot;id&quot;: &quot;GLY216.A&quot;, &quot;label&quot;: &quot;GLY216.A&quot;, &quot;color&quot;: &quot;#59e382&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Aliphatic&quot;}, {&quot;id&quot;: &quot;GLY219.A&quot;, &quot;label&quot;: &quot;GLY219.A&quot;, &quot;color&quot;: &quot;#59e382&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Aliphatic&quot;}, {&quot;id&quot;: &quot;HIS57.A&quot;, &quot;label&quot;: &quot;HIS57.A&quot;, &quot;color&quot;: &quot;#5979e3&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Basic&quot;}, {&quot;id&quot;: &quot;LEU99.A&quot;, &quot;label&quot;: &quot;LEU99.A&quot;, &quot;color&quot;: &quot;#59e382&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Aliphatic&quot;}, {&quot;id&quot;: &quot;SER190.A&quot;, &quot;label&quot;: &quot;SER190.A&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Polar&quot;}, {&quot;id&quot;: &quot;SER195.A&quot;, &quot;label&quot;: &quot;SER195.A&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Polar&quot;}, {&quot;id&quot;: &quot;SER214.A&quot;, &quot;label&quot;: &quot;SER214.A&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Polar&quot;}, {&quot;id&quot;: &quot;THR98.A&quot;, &quot;label&quot;: &quot;THR98.A&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Polar&quot;}, {&quot;id&quot;: &quot;TRP215.A&quot;, &quot;label&quot;: &quot;TRP215.A&quot;, &quot;color&quot;: &quot;#b559e3&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Aromatic&quot;}, {&quot;id&quot;: &quot;VAL213.A&quot;, &quot;label&quot;: &quot;VAL213.A&quot;, &quot;color&quot;: &quot;#59e382&quot;, &quot;shape&quot;: &quot;box&quot;, &quot;borderWidth&quot;: 0, &quot;physics&quot;: true, &quot;mass&quot;: 2, &quot;group&quot;: &quot;protein&quot;, &quot;residue_type&quot;: &quot;Aliphatic&quot;}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 0, &quot;x&quot;: 39.92991297446747, &quot;y&quot;: 21.840942607661304, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot;O&quot;, &quot;shape&quot;: &quot;circle&quot;, &quot;color&quot;: &quot;white&quot;, &quot;font&quot;: {&quot;color&quot;: &quot;red&quot;}, &quot;id&quot;: 1, &quot;x&quot;: 54.523563057506436, &quot;y&quot;: 72.27183965752364, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 2, &quot;x&quot;: 76.30752591376651, &quot;y&quot;: -16.012977623122506, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot;NH&quot;, &quot;shape&quot;: &quot;ellipse&quot;, &quot;color&quot;: &quot;white&quot;, &quot;font&quot;: {&quot;color&quot;: &quot;blue&quot;}, &quot;id&quot;: 3, &quot;x&quot;: 112.68513885306558, &quot;y&quot;: -53.866897853906295, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 4, &quot;x&quot;: 163.65640187540362, &quot;y&quot;: -41.28992103482769, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 5, &quot;x&quot;: 214.087298925266, &quot;y&quot;: -55.88357111786665, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 6, &quot;x&quot;: 260.06659714652477, &quot;y&quot;: -30.542810768568756, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 7, &quot;x&quot;: 274.66024722956377, &quot;y&quot;: 19.888086281293624, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 8, &quot;x&quot;: 249.31948688026586, &quot;y&quot;: 65.86738450255243, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 9, &quot;x&quot;: 198.88858983040348, &quot;y&quot;: 80.46103458559136, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 10, &quot;x&quot;: 152.9092916091447, &quot;y&quot;: 55.12027423629349, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 11, &quot;x&quot;: 138.3156415261057, &quot;y&quot;: 4.689377186431113, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot;N&quot;, &quot;shape&quot;: &quot;circle&quot;, &quot;color&quot;: &quot;white&quot;, &quot;font&quot;: {&quot;color&quot;: &quot;blue&quot;}, &quot;id&quot;: 12, &quot;x&quot;: -11.041350047870512, &quot;y&quot;: 9.263965788582732, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 13, &quot;x&quot;: -30.826518758627124, &quot;y&quot;: -39.36521371392273, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 14, &quot;x&quot;: -40.06875912972104, &quot;y&quot;: -91.04529684972005, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot;O&quot;, &quot;shape&quot;: &quot;circle&quot;, &quot;color&quot;: &quot;white&quot;, &quot;font&quot;: {&quot;color&quot;: &quot;red&quot;}, &quot;id&quot;: 15, &quot;x&quot;: 0.0663855500242011, &quot;y&quot;: -124.88935336686808, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 16, &quot;x&quot;: -83.18957017477092, &quot;y&quot;: -35.57564297434271, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 17, &quot;x&quot;: -95.76654699384945, &quot;y&quot;: 15.395620047995283, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 18, &quot;x&quot;: -51.17649472761578, &quot;y&quot;: 43.10802230573083, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot;N&quot;, &quot;shape&quot;: &quot;circle&quot;, &quot;color&quot;: &quot;white&quot;, &quot;font&quot;: {&quot;color&quot;: &quot;blue&quot;}, &quot;id&quot;: 19, &quot;x&quot;: -89.4461441805602, &quot;y&quot;: -108.88132346836925, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 20, &quot;x&quot;: -129.58128886030542, &quot;y&quot;: -75.03726695122118, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 21, &quot;x&quot;: -169.71643354005073, &quot;y&quot;: -41.193210434073116, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 22, &quot;x&quot;: -160.47419316895687, &quot;y&quot;: 10.486872701724266, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 23, &quot;x&quot;: -200.6093378487022, &quot;y&quot;: 44.330929218872335, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 24, &quot;x&quot;: -249.98672289954132, &quot;y&quot;: 26.49490260022307, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 25, &quot;x&quot;: -290.1218675792867, &quot;y&quot;: 60.33895911737116, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot;NH&quot;, &quot;shape&quot;: &quot;ellipse&quot;, &quot;color&quot;: &quot;white&quot;, &quot;font&quot;: {&quot;color&quot;: &quot;blue&quot;}, &quot;id&quot;: 26, &quot;x&quot;: -339.49925263012574, &quot;y&quot;: 42.50293249872184, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot;N&quot;, &quot;shape&quot;: &quot;circle&quot;, &quot;color&quot;: &quot;white&quot;, &quot;font&quot;: {&quot;color&quot;: &quot;blue&quot;}, &quot;id&quot;: 27, &quot;x&quot;: -280.87962720819286, &quot;y&quot;: 112.0190422531685, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 28, &quot;x&quot;: -259.2289632706352, &quot;y&quot;: -25.18518053557425, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot; &quot;, &quot;shape&quot;: &quot;dot&quot;, &quot;color&quot;: &quot;black&quot;, &quot;size&quot;: 5.6000000000000005, &quot;id&quot;: 29, &quot;x&quot;: -219.09381859088995, &quot;y&quot;: -59.029237052722316, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot;H&quot;, &quot;shape&quot;: &quot;circle&quot;, &quot;color&quot;: &quot;white&quot;, &quot;font&quot;: {&quot;color&quot;: &quot;grey&quot;}, &quot;id&quot;: 39, &quot;x&quot;: 322.56988937616796, &quot;y&quot;: -1.5808724588111256, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot;H&quot;, &quot;shape&quot;: &quot;circle&quot;, &quot;color&quot;: &quot;white&quot;, &quot;font&quot;: {&quot;color&quot;: &quot;grey&quot;}, &quot;id&quot;: 55, &quot;x&quot;: -98.68838455165411, &quot;y&quot;: -160.56140660416656, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot;H&quot;, &quot;shape&quot;: &quot;circle&quot;, &quot;color&quot;: &quot;white&quot;, &quot;font&quot;: {&quot;color&quot;: &quot;grey&quot;}, &quot;id&quot;: 61, &quot;x&quot;: -321.0147718879382, &quot;y&quot;: 145.86309877031655, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;label&quot;: &quot;H&quot;, &quot;shape&quot;: &quot;circle&quot;, &quot;color&quot;: &quot;white&quot;, &quot;font&quot;: {&quot;color&quot;: &quot;grey&quot;}, &quot;id&quot;: 62, &quot;x&quot;: -231.50224215735366, &quot;y&quot;: 129.8550688718179, &quot;fixed&quot;: true, &quot;group&quot;: &quot;ligand&quot;, &quot;borderWidth&quot;: 0}, {&quot;id&quot;: -5535647359809049556, &quot;x&quot;: 35.89544121047848, &quot;y&quot;: 23.008434614304424, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 6391740080644986832, &quot;x&quot;: 50.48909129351745, &quot;y&quot;: 73.43933166416676, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 2315293112383831390, &quot;x&quot;: 43.96438473845646, &quot;y&quot;: 20.673450601018185, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: -8264080661533445904, &quot;x&quot;: 58.558034821495426, &quot;y&quot;: 71.10434765088053, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: -3466872540174694247, &quot;x&quot;: -37.36123460834919, &quot;y&quot;: -87.83448527534043, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: -2890844732736722684, &quot;x&quot;: 2.7739100713960476, &quot;y&quot;: -121.67854179248846, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 2296617213547448025, &quot;x&quot;: -42.77628365109288, &quot;y&quot;: -94.25610842409966, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 4413122294551891259, &quot;x&quot;: -2.641138971347645, &quot;y&quot;: -128.1001649412477, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 7776769002111559312, &quot;x&quot;: -173.8508401909145, &quot;y&quot;: -40.45383120438561, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: -1264565713112470756, &quot;x&quot;: -164.60859981982065, &quot;y&quot;: 11.226251931411774, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 3673886289685184533, &quot;x&quot;: -165.58202688918695, &quot;y&quot;: -41.93258966376062, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: -7518359010972987247, &quot;x&quot;: -156.3397865180931, &quot;y&quot;: 9.747493472036759, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: -3188109844631951427, &quot;x&quot;: -168.2895514105588, &quot;y&quot;: -45.14340123814025, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: -5563051835727099200, &quot;x&quot;: -217.66693646139802, &quot;y&quot;: -62.97942785678945, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 2217705376328464899, &quot;x&quot;: -171.14331566954266, &quot;y&quot;: -37.24301963000598, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 1581836982009448679, &quot;x&quot;: -220.52070072038188, &quot;y&quot;: -55.07904624865518, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: -8083744273500865264, &quot;x&quot;: -163.18171769032872, &quot;y&quot;: 7.27606112734464, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 4106976607762279870, &quot;x&quot;: -203.31686237007406, &quot;y&quot;: 41.12011764449271, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: -233933355908717070, &quot;x&quot;: -157.76666864758502, &quot;y&quot;: 13.697684276103892, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: -3330621465142053513, &quot;x&quot;: -197.90181332733036, &quot;y&quot;: 47.54174079325196, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 4573701437802496251, &quot;x&quot;: -199.18245571921028, &quot;y&quot;: 40.3807384148052, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 2027812194790067323, &quot;x&quot;: -248.5598407700494, &quot;y&quot;: 22.544711796155937, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: -43587748891064762, &quot;x&quot;: -202.03621997819414, &quot;y&quot;: 48.28112002293947, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 7349370941755286465, &quot;x&quot;: -251.41360502903325, &quot;y&quot;: 30.445093404290205, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 3794433979354703565, &quot;x&quot;: -245.85231624867754, &quot;y&quot;: 25.755523370535563, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 4348839722039258908, &quot;x&quot;: -255.0945566197714, &quot;y&quot;: -25.92455976526176, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 4525441825587320098, &quot;x&quot;: -254.1211295504051, &quot;y&quot;: 27.23428182991058, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 2480742604958622697, &quot;x&quot;: -263.363369921499, &quot;y&quot;: -24.445801305886743, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 676064199768288179, &quot;x&quot;: -288.69498544979473, &quot;y&quot;: 56.38876831330403, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 7616605487933146360, &quot;x&quot;: -338.0723705006338, &quot;y&quot;: 38.552741694654706, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 8205015407944528923, &quot;x&quot;: -291.54874970877864, &quot;y&quot;: 64.2891499214383, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: -7596883567215709610, &quot;x&quot;: -340.9261347596177, &quot;y&quot;: 46.453123302788974, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 9109355908060369854, &quot;x&quot;: -256.5214387492633, &quot;y&quot;: -21.974368961194628, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 3609141865272994084, &quot;x&quot;: -216.3862940695181, &quot;y&quot;: -55.8184254783427, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 8627230411913182353, &quot;x&quot;: -261.93648779200703, &quot;y&quot;: -28.395992109953873, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}, {&quot;id&quot;: 8183001495646378461, &quot;x&quot;: -221.8013431122618, &quot;y&quot;: -62.240048627101935, &quot;shape&quot;: &quot;text&quot;, &quot;label&quot;: &quot; &quot;, &quot;fixed&quot;: true, &quot;physics&quot;: false}];
        edges = [{&quot;from&quot;: 39, &quot;to&quot;: &quot;ASN97.A&quot;, &quot;title&quot;: &quot;VdWContact: 2.48\u00c5&quot;, &quot;interaction_type&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 62, &quot;to&quot;: &quot;ASP189.A&quot;, &quot;title&quot;: &quot;HBDonor: 2.72\u00c5&quot;, &quot;interaction_type&quot;: &quot;HBAcceptor/HBDonor&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 26, &quot;to&quot;: &quot;ASP189.A&quot;, &quot;title&quot;: &quot;VdWContact: 2.87\u00c5&quot;, &quot;interaction_type&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 8, &quot;to&quot;: &quot;GLN175.A&quot;, &quot;title&quot;: &quot;Hydrophobic: 4.43\u00c5&quot;, &quot;interaction_type&quot;: &quot;Hydrophobic&quot;, &quot;color&quot;: &quot;#59e382&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 10, &quot;to&quot;: &quot;GLN175.A&quot;, &quot;title&quot;: &quot;VdWContact: 3.03\u00c5&quot;, &quot;interaction_type&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 15, &quot;to&quot;: &quot;GLN192.A&quot;, &quot;title&quot;: &quot;HBAcceptor: 3.12\u00c5&quot;, &quot;interaction_type&quot;: &quot;HBAcceptor/HBDonor&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 15, &quot;to&quot;: &quot;GLN192.A&quot;, &quot;title&quot;: &quot;VdWContact: 2.19\u00c5&quot;, &quot;interaction_type&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 1, &quot;to&quot;: &quot;GLY216.A&quot;, &quot;title&quot;: &quot;HBAcceptor: 3.47\u00c5&quot;, &quot;interaction_type&quot;: &quot;HBAcceptor/HBDonor&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 1, &quot;to&quot;: &quot;GLY216.A&quot;, &quot;title&quot;: &quot;VdWContact: 2.43\u00c5&quot;, &quot;interaction_type&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 61, &quot;to&quot;: &quot;GLY219.A&quot;, &quot;title&quot;: &quot;HBDonor: 2.95\u00c5&quot;, &quot;interaction_type&quot;: &quot;HBAcceptor/HBDonor&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 27, &quot;to&quot;: &quot;GLY219.A&quot;, &quot;title&quot;: &quot;VdWContact: 2.95\u00c5&quot;, &quot;interaction_type&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 16, &quot;to&quot;: &quot;HIS57.A&quot;, &quot;title&quot;: &quot;Hydrophobic: 4.06\u00c5&quot;, &quot;interaction_type&quot;: &quot;Hydrophobic&quot;, &quot;color&quot;: &quot;#59e382&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 5, &quot;to&quot;: &quot;LEU99.A&quot;, &quot;title&quot;: &quot;Hydrophobic: 4.47\u00c5&quot;, &quot;interaction_type&quot;: &quot;Hydrophobic&quot;, &quot;color&quot;: &quot;#59e382&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 6, &quot;to&quot;: &quot;LEU99.A&quot;, &quot;title&quot;: &quot;VdWContact: 3.30\u00c5&quot;, &quot;interaction_type&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 25, &quot;to&quot;: &quot;SER190.A&quot;, &quot;title&quot;: &quot;VdWContact: 3.19\u00c5&quot;, &quot;interaction_type&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 20, &quot;to&quot;: &quot;SER195.A&quot;, &quot;title&quot;: &quot;VdWContact: 3.20\u00c5&quot;, &quot;interaction_type&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 55, &quot;to&quot;: &quot;SER214.A&quot;, &quot;title&quot;: &quot;HBDonor: 2.96\u00c5&quot;, &quot;interaction_type&quot;: &quot;HBAcceptor/HBDonor&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 19, &quot;to&quot;: &quot;SER214.A&quot;, &quot;title&quot;: &quot;VdWContact: 2.96\u00c5&quot;, &quot;interaction_type&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 7, &quot;to&quot;: &quot;THR98.A&quot;, &quot;title&quot;: &quot;VdWContact: 3.21\u00c5&quot;, &quot;interaction_type&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 5, &quot;to&quot;: &quot;TRP215.A&quot;, &quot;title&quot;: &quot;Hydrophobic: 4.39\u00c5&quot;, &quot;interaction_type&quot;: &quot;Hydrophobic&quot;, &quot;color&quot;: &quot;#59e382&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 1, &quot;to&quot;: &quot;TRP215.A&quot;, &quot;title&quot;: &quot;VdWContact: 2.50\u00c5&quot;, &quot;interaction_type&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: 28, &quot;to&quot;: &quot;VAL213.A&quot;, &quot;title&quot;: &quot;Hydrophobic: 3.89\u00c5&quot;, &quot;interaction_type&quot;: &quot;Hydrophobic&quot;, &quot;color&quot;: &quot;#59e382&quot;, &quot;smooth&quot;: {&quot;type&quot;: &quot;cubicBezier&quot;, &quot;roundness&quot;: 0.2}, &quot;dashes&quot;: [10], &quot;width&quot;: 6.0, &quot;group&quot;: &quot;interaction&quot;}, {&quot;from&quot;: -5535647359809049556, &quot;to&quot;: 6391740080644986832, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 2315293112383831390, &quot;to&quot;: -8264080661533445904, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 0, &quot;to&quot;: 2, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 0, &quot;to&quot;: 12, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 2, &quot;to&quot;: 3, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 3, &quot;to&quot;: 4, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 4, &quot;to&quot;: 5, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 4, &quot;to&quot;: 11, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 5, &quot;to&quot;: 6, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 6, &quot;to&quot;: 7, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 7, &quot;to&quot;: 8, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 7, &quot;to&quot;: 39, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 8, &quot;to&quot;: 9, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 9, &quot;to&quot;: 10, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 10, &quot;to&quot;: 11, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 12, &quot;to&quot;: 13, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 12, &quot;to&quot;: 18, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 13, &quot;to&quot;: 14, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 13, &quot;to&quot;: 16, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: -3466872540174694247, &quot;to&quot;: -2890844732736722684, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 2296617213547448025, &quot;to&quot;: 4413122294551891259, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 14, &quot;to&quot;: 19, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 16, &quot;to&quot;: 17, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 17, &quot;to&quot;: 18, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 19, &quot;to&quot;: 20, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 19, &quot;to&quot;: 55, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 20, &quot;to&quot;: 21, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 7776769002111559312, &quot;to&quot;: -1264565713112470756, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: [10], &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 3673886289685184533, &quot;to&quot;: -7518359010972987247, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: [10], &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: -3188109844631951427, &quot;to&quot;: -5563051835727099200, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: [10], &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 2217705376328464899, &quot;to&quot;: 1581836982009448679, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: [10], &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: -8083744273500865264, &quot;to&quot;: 4106976607762279870, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: [10], &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: -233933355908717070, &quot;to&quot;: -3330621465142053513, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: [10], &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 4573701437802496251, &quot;to&quot;: 2027812194790067323, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: [10], &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: -43587748891064762, &quot;to&quot;: 7349370941755286465, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: [10], &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 24, &quot;to&quot;: 25, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 3794433979354703565, &quot;to&quot;: 4348839722039258908, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: [10], &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 4525441825587320098, &quot;to&quot;: 2480742604958622697, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: [10], &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 676064199768288179, &quot;to&quot;: 7616605487933146360, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 8205015407944528923, &quot;to&quot;: -7596883567215709610, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 25, &quot;to&quot;: 27, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 27, &quot;to&quot;: 61, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 27, &quot;to&quot;: 62, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 9109355908060369854, &quot;to&quot;: 3609141865272994084, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: [10], &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}, {&quot;from&quot;: 8627230411913182353, &quot;to&quot;: 8183001495646378461, &quot;color&quot;: &quot;black&quot;, &quot;physics&quot;: false, &quot;dashes&quot;: [10], &quot;group&quot;: &quot;ligand&quot;, &quot;width&quot;: 4}];
        ifp = drawGraph(&#x27;mynetwork&#x27;, nodes, edges, {&quot;width&quot;: &quot;100%&quot;, &quot;height&quot;: &quot;500px&quot;, &quot;nodes&quot;: {&quot;font&quot;: {&quot;size&quot;: 20}}, &quot;physics&quot;: {&quot;barnesHut&quot;: {&quot;avoidOverlap&quot;: 0.8, &quot;springConstant&quot;: 0.1}}});
    
        legend_buttons = [{&quot;index&quot;: 0, &quot;label&quot;: &quot;Acidic&quot;, &quot;color&quot;: &quot;#e35959&quot;, &quot;group&quot;: &quot;residues&quot;}, {&quot;index&quot;: 1, &quot;label&quot;: &quot;Aliphatic&quot;, &quot;color&quot;: &quot;#59e382&quot;, &quot;group&quot;: &quot;residues&quot;}, {&quot;index&quot;: 2, &quot;label&quot;: &quot;Aromatic&quot;, &quot;color&quot;: &quot;#b559e3&quot;, &quot;group&quot;: &quot;residues&quot;}, {&quot;index&quot;: 3, &quot;label&quot;: &quot;Basic&quot;, &quot;color&quot;: &quot;#5979e3&quot;, &quot;group&quot;: &quot;residues&quot;}, {&quot;index&quot;: 4, &quot;label&quot;: &quot;Polar&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;group&quot;: &quot;residues&quot;}, {&quot;index&quot;: 0, &quot;label&quot;: &quot;HBAcceptor/HBDonor&quot;, &quot;color&quot;: &quot;#59bee3&quot;, &quot;group&quot;: &quot;interactions&quot;}, {&quot;index&quot;: 1, &quot;label&quot;: &quot;Hydrophobic&quot;, &quot;color&quot;: &quot;#59e382&quot;, &quot;group&quot;: &quot;interactions&quot;}, {&quot;index&quot;: 2, &quot;label&quot;: &quot;VdWContact&quot;, &quot;color&quot;: &quot;#dfab43&quot;, &quot;group&quot;: &quot;interactions&quot;}];
        legend = document.getElementById(&#x27;networklegend&#x27;);
        var div_residues = document.createElement(&#x27;div&#x27;);
        var div_interactions = document.createElement(&#x27;div&#x27;);
        var disabled = [];
        var legend_callback = function() {
            this.classList.toggle(&quot;disabled&quot;);
            var hide = this.classList.contains(&quot;disabled&quot;);
            var show = !hide;
            var btn_label = this.innerHTML;
            if (hide) {
                disabled.push(btn_label);
            } else {
                disabled = disabled.filter(x =&gt; x !== btn_label);
            }
            var node_update = [],
                edge_update = [];
            // click on residue type
            if (this.classList.contains(&quot;residues&quot;)) {
                nodes.forEach((node) =&gt; {
                    // find nodes corresponding to this type
                    if (node.residue_type === btn_label) {
                        // if hiding this type and residue isn&#x27;t already hidden
                        if (hide &amp;&amp; !node.hidden) {
                            node.hidden = true;
                            node_update.push(node);
                        // if showing this type and residue isn&#x27;t already visible
                        } else if (show &amp;&amp; node.hidden) {
                            // display if there&#x27;s at least one of its edge that isn&#x27;t hidden
                            num_edges_active = edges.filter(x =&gt; x.to === node.id)
                                                    .map(x =&gt; Boolean(x.hidden))
                                                    .filter(x =&gt; !x)
                                                    .length;
                            if (num_edges_active &gt; 0) {
                                node.hidden = false;
                                node_update.push(node);
                            }
                        }
                    }
                });
                ifp.body.data.nodes.update(node_update);
            // click on interaction type
            } else {
                edges.forEach((edge) =&gt; {
                    // find edges corresponding to this type
                    if (edge.interaction_type === btn_label) {
                        edge.hidden = !edge.hidden;
                        edge_update.push(edge);
                        // number of active edges for the corresponding residue
                        var num_edges_active = edges.filter(x =&gt; x.to === edge.to)
                                               .map(x =&gt; Boolean(x.hidden))
                                               .filter(x =&gt; !x)
                                               .length;
                        // find corresponding residue
                        var ix = nodes.findIndex(x =&gt; x.id === edge.to);
                        // only change visibility if residue_type not being hidden
                        if (!(disabled.includes(nodes[ix].residue_type))) {
                            // hide if no edge being shown for this residue
                            if (hide &amp;&amp; (num_edges_active === 0)) {
                                nodes[ix].hidden = true;
                                node_update.push(nodes[ix]);
                            // show if edges are being shown
                            } else if (show &amp;&amp; (num_edges_active &gt; 0)) {
                                nodes[ix].hidden = false;
                                node_update.push(nodes[ix]);
                            }
                        }
                    }
                });
                ifp.body.data.nodes.update(node_update);
                ifp.body.data.edges.update(edge_update);
            }
        };
        legend_buttons.forEach(function(v,i) {
            if (v.group === &quot;residues&quot;) {
                var div = div_residues;
                var border = &quot;none&quot;;
                var color = v.color;
            } else {
                var div = div_interactions;
                var border = &quot;3px dashed &quot; + v.color;
                var color = &quot;white&quot;;
            }
            var button = div.appendChild(document.createElement(&#x27;button&#x27;));
            button.classList.add(&quot;legend-btn&quot;, v.group);
            button.innerHTML = v.label;
            Object.assign(button.style, {
                &quot;cursor&quot;: &quot;pointer&quot;,
                &quot;background-color&quot;: color,
                &quot;border&quot;: border,
                &quot;border-radius&quot;: &quot;5px&quot;,
                &quot;padding&quot;: &quot;5px&quot;,
                &quot;margin&quot;: &quot;5px&quot;,
                &quot;font&quot;: &quot;14px &#x27;Arial&#x27;, sans-serif&quot;,
            });
            button.onclick = legend_callback;
        });
        legend.appendChild(div_residues);
        legend.appendChild(div_interactions);
        
        &lt;/script&gt;
        &lt;/body&gt;
        &lt;/html&gt;
    "></iframe></div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="EC_class_ligands_search.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Enzyme Commission Class with Ligands</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-the-structure">Downloading the Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#view-the-structure">View the structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#making-a-map-of-ligand-contacts">Making a Map of Ligand Contacts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#structure-preparation">Structure Preparation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-the-binding-site">Visualizing the Binding Site</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Molecular Sciences Software Institute
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>