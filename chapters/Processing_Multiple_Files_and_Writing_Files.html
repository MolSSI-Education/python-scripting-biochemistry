

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Processing Multiple Files and Writing Files &#8212; Python Data and Scripting for Biochemists</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-FHKVGE8HKZ"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-FHKVGE8HKZ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/Processing_Multiple_Files_and_Writing_Files';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with Pandas" href="Working_with_Pandas.html" />
    <link rel="prev" title="File Parsing" href="File_Parsing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="setup.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/molssi_main_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/molssi_main_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="setup.html">
                    Set Up
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="workshop_schedule.html">Workshop Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="File_Parsing.html">File Parsing</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Processing Multiple Files and Writing Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="Working_with_Pandas.html">Working with Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Linear_Regression.html">Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="Creating_Plots_in_Jupyter_Notebooks.html">Creating Plots in Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinear_regression_part_1.html">Nonlinear Regression Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinear_regression_part_2.html">Nonlinear Regression Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="biopython_mmcif.html">Analyzing MMCIF Files using Biopython</a></li>
<li class="toctree-l1"><a class="reference internal" href="rcsb_api.html">Retrieving Information from the PDB using the Web API</a></li>
<li class="toctree-l1"><a class="reference internal" href="MolVis_with_iCN3D.html">Molecular Visualization with iCN3D</a></li>



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/MolSSI-Education/python-scripting-biochemistry" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/MolSSI-Education/python-scripting-biochemistry/issues/new?title=Issue%20on%20page%20%2Fchapters/Processing_Multiple_Files_and_Writing_Files.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/Processing_Multiple_Files_and_Writing_Files.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Processing Multiple Files and Writing Files</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#processing-multiple-files">Processing multiple files</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-libraries">Importing libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-multiple-files-with-nested-for-loops">Reading multiple files with nested for loops</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#printing-to-a-file">Printing to a File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-final-note-about-string-formatting">A final note about string formatting</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="processing-multiple-files-and-writing-files">
<h1>Processing Multiple Files and Writing Files<a class="headerlink" href="#processing-multiple-files-and-writing-files" title="Permalink to this headline">#</a></h1>
<div class="overview admonition">
<p class="admonition-title">Overview</p>
<p>Questions:</p>
<ul class="simple">
<li><p>How do I analyze multiple files at once?</p></li>
</ul>
<p>Objectives:</p>
<ul class="simple">
<li><p>Import a python library.</p></li>
<li><p>Use python library funtions.</p></li>
<li><p>Process multiple files using a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p></li>
<li><p>Print output to a new text file.</p></li>
</ul>
</div>
<section id="processing-multiple-files">
<h2>Processing multiple files<a class="headerlink" href="#processing-multiple-files" title="Permalink to this headline">#</a></h2>
<p>In our previous lesson, we parsed values from output files.  While you might have seen the utility of doing such a thing, you might have also wondered why we didn’t just search the file and cut and paste the values we wanted into a spreadsheet.  If you only have 1 or 2 files, this might be a very reasonable thing to do.  But what if you had 100 files to analyze?  What if you had 1000?  In such a case the cutting and pasting method would be very tedious and time consuming.</p>
<p>One of the real powers of writing a program to analyze your data is that you can just as easily analyze 100 files as 1 file.  In this example, we are going to parse the PDB files for a series of enzyme structures in the <a class="reference external" href="https://www.rcsb.org/">Protein Data Bank</a> and extract resolution data and atom counts for each one.  The PDB files are all saved in a folder called PDB_files that you should have downloaded in the setup for this lesson.  Make sure the folder is in the same directory as the directory where you are writing and executing your code.</p>
<p>To analyze multiple files, we will need to import a python <strong>library</strong>.  A <strong>library</strong> is a set of modules which contain functions. The functions within a library or module are usually related to one another. Using libraries in Python reduces the amount of code you have to write. In the last lesson, we imported <code class="docutils literal notranslate"><span class="pre">os.path</span></code>, which was a module that handled filepaths for us.</p>
<p>In this lesson, we will be using the <code class="docutils literal notranslate"><span class="pre">glob</span></code> library, which will help us read in multiple files from our computer.  Within a library there are modules and functions which do a specific computational task.  Usually a function has some type of input and gives a particular output.  To use a function that is in a library, you often use the dot notation introduced earlier.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">library_name</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">library_name</span><span class="o">.</span><span class="n">function_name</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
<section id="importing-libraries">
<h3>Importing libraries<a class="headerlink" href="#importing-libraries" title="Permalink to this headline">#</a></h3>
<p>We are going to import two libraries.  One is the <code class="docutils literal notranslate"><span class="pre">os</span></code> library which controls functions related to the operating system of your computer. We used this library in the last lesson to handle filepaths.  The other is the <code class="docutils literal notranslate"><span class="pre">glob</span></code> library which contains functions to help us analyze multiple files.  If we are going to analyze multiple files, we first need to specify where those files are located.</p>
<div class="exercise admonition">
<p class="admonition-title">Check Your Understanding</p>
<p>How would you use the <code class="docutils literal notranslate"><span class="pre">os.path</span></code> module to point to the directory where your PDB files are located?</p>
<div class="solution dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    
    <span class="n">outfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;PDB_files&#39;</span><span class="p">)</span>    
</pre></div>
</div>
</div>
</div>
<p>In order to get all of the files which match a specific pattern, we will use the wildcard character <code class="docutils literal notranslate"><span class="pre">*</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">file_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;PDB_files&#39;</span><span class="p">,</span> <span class="s1">&#39;*.pdb&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">file_location</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data/PDB_files/*.pdb
</pre></div>
</div>
</div>
</div>
<p>This specifies that we want to look for all the files in a directory called <code class="docutils literal notranslate"><span class="pre">data/PDB_files</span></code> that end in “.pdb”.  The * is the wildcard character which matches any character or series of characters.</p>
<p>Next we are going to use a function called <code class="docutils literal notranslate"><span class="pre">glob</span></code> in the library called <code class="docutils literal notranslate"><span class="pre">glob</span></code>.  It is a little confusing since the function and the library have the same name, but we will see other examples where this is not the case later.  The output of the function <code class="docutils literal notranslate"><span class="pre">glob</span></code> is a list of all the filenames that fit the pattern specified in the input.   The input is the file location.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="n">filenames</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">file_location</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;data/PDB_files/5veu.pdb&#39;, &#39;data/PDB_files/4eyr.pdb&#39;, &#39;data/PDB_files/2pkr.pdb&#39;, &#39;data/PDB_files/3iva.pdb&#39;, &#39;data/PDB_files/6zt7.pdb&#39;, &#39;data/PDB_files/1ddo.pdb&#39;, &#39;data/PDB_files/3vnd.pdb&#39;, &#39;data/PDB_files/7tim.pdb&#39;, &#39;data/PDB_files/5eu9.pdb&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="reading-multiple-files-with-nested-for-loops">
<h3>Reading multiple files with nested for loops<a class="headerlink" href="#reading-multiple-files-with-nested-for-loops" title="Permalink to this headline">#</a></h3>
<p>Now you have a list of all the files which end in <code class="docutils literal notranslate"><span class="pre">*.pdb</span></code> in the <code class="docutils literal notranslate"><span class="pre">PDB_files</span></code> directory. To parse every file we just read in, we will use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to go through each file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">outfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;RESOLUTION.&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">res_line</span> <span class="o">=</span> <span class="n">line</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">res_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">resolution</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.91
1.8
2.4
2.7
1.85
3.1
2.6
1.9
2.05
</pre></div>
</div>
</div>
</div>
<p>Notice that in this code we actually used two <code class="docutils literal notranslate"><span class="pre">for</span></code> loops, one nested inside the other.  The outer <code class="docutils literal notranslate"><span class="pre">for</span></code> loop counts over the filenames we read in earlier.  The inner <code class="docutils literal notranslate"><span class="pre">for</span></code> loop counts over the lines in each file, just as we did in our previous file parsing lesson.</p>
<p>The output our code currently generates is not that useful.  It doesn’t show us which file each resolution value came from.</p>
<p>We want to print the name of the molecule with the resolution. We can use <code class="docutils literal notranslate"><span class="pre">os.path.basename</span></code>, which is another function in <code class="docutils literal notranslate"><span class="pre">os.path</span></code> to get just the name of the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_file</span> <span class="o">=</span> <span class="n">filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># look above to recall the content of filenames</span>
<span class="nb">print</span><span class="p">(</span><span class="n">first_file</span><span class="p">)</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">first_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data/PDB_files/5veu.pdb
5veu.pdb
</pre></div>
</div>
</div>
</div>
<div class="exercise admonition">
<p class="admonition-title">Check your understanding</p>
<p>How would you extract the PDB ID from the example above?</p>
<div class="solution dropdown admonition">
<p class="admonition-title">Solution</p>
<p>You can use the str.split function introduced in the last lesson, and split at the ‘.’ character.</p>
<p>split_filename = file_name.split(‘.’)<br />
molecule_name = split_filename[0]<br />
print(molecule_name)</p>
</div>
</div>
<p>Using the solution above, we can modify our loop so that it prints the file name along with each resolution value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
    <span class="c1"># Get the PDB ID</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">split_filename</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">molecule_name</span> <span class="o">=</span> <span class="n">split_filename</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Read the data</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">outfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="c1"># Loop through the data</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;RESOLUTION.&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">res_line</span> <span class="o">=</span> <span class="n">line</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">res_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">resolution</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">molecule_name</span><span class="p">,</span> <span class="s2">&quot;: &quot;</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="s2">&quot; Angstroms&quot;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5veu: 2.91 Angstroms
4eyr: 1.8 Angstroms
2pkr: 2.4 Angstroms
3iva: 2.7 Angstroms
6zt7: 1.85 Angstroms
1ddo: 3.1 Angstroms
3vnd: 2.6 Angstroms
7tim: 1.9 Angstroms
5eu9: 2.05 Angstroms
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="printing-to-a-file">
<h2>Printing to a File<a class="headerlink" href="#printing-to-a-file" title="Permalink to this headline">#</a></h2>
<p>Finally, it might be useful to print our results in a new file, such that we could share our results with colleagues or e-mail them to our advisors.  Much like when we read in a file, the first step to writing output to a file is opening that file for writing.  In general, to open a file for writing you have two options. The first is uses the <code class="docutils literal notranslate"><span class="pre">open</span></code> command.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">filehandle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;file_name.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w+&#39;</span><span class="p">):</span>
<span class="n">take</span> <span class="n">some</span> <span class="n">actions</span>
<span class="n">use</span> <span class="n">filehandle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span> <span class="n">to</span> <span class="n">the</span> <span class="n">file</span>
<span class="n">filehandle</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The filehandle.close() command is very important here. Think about a computer as someone who has a very good memory, but is very slow at writing. Therefore, when you tell the computer to write a line, it remembers what you want it to write, but it doesn’t actually write the new file until you tell it you are finished. The datafile.close() command tells the computer you are finished giving it lines to write and that it should go ahead and write the file now. If you are trying to write a file and the file keeps coming up empty, it is probably because you forgot to close the file.</p>
<p>The second (preferred) approach in python is to use the <code class="docutils literal notranslate"><span class="pre">with</span></code> context manager that we have already used for reading a file. The advantage to this approach is that all of the steps that generate input for the file are indented under the initial <code class="docutils literal notranslate"><span class="pre">with</span></code> statement and the file closes automatically when all of the actions indented beneath the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement are completed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;file_name.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">filehandle</span><span class="p">:</span>
    <span class="n">take</span> <span class="n">some</span> <span class="n">actions</span>
    <span class="n">use</span> <span class="n">filehandle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">)</span> <span class="n">to</span> <span class="n">add</span> <span class="n">content</span> <span class="n">to</span> <span class="n">the</span> <span class="n">file</span>
</pre></div>
</div>
<p>Let’s examine the syntax of the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;file_name.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">filehandle</span><span class="p">:</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">w</span></code> instructs python to open the file for writing.  If you use <code class="docutils literal notranslate"><span class="pre">w+</span></code> that means open the file for writing and if the file does not exist, create it.  You can also use <code class="docutils literal notranslate"><span class="pre">a</span></code> for append to an existing file or <code class="docutils literal notranslate"><span class="pre">a+</span></code>.  The difference between <code class="docutils literal notranslate"><span class="pre">w+</span></code> and <code class="docutils literal notranslate"><span class="pre">a+</span></code> is that <code class="docutils literal notranslate"><span class="pre">w+</span></code> will overwrite the file if it already exists, whereas <code class="docutils literal notranslate"><span class="pre">a+</span></code> will keep what is already there and just add additional text to the file.</p>
<p>Python can only write strings to files.  In the next cell, we want to print the contents of two variables, <code class="docutils literal notranslate"><span class="pre">molecule_name</span></code> and <code class="docutils literal notranslate"><span class="pre">resolution</span></code>.  To convert what we have now to a string, you place a capital <strong>F</strong> in front of the line you want to print and enclose the content to be printed in single quotes.  Each python variable is placed in braces <code class="docutils literal notranslate"><span class="pre">{}</span></code>. Then you can either print the line (as we have done before) or you can use the <code class="docutils literal notranslate"><span class="pre">filehandle.write()</span></code> command to print it to a file.</p>
<p>To make the printing neater, we will separate the PDB ID from the resolution using a tab. To insert a tab, we use the special character <code class="docutils literal notranslate"><span class="pre">\t</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;resolutions.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="c1"># Get the PDB ID</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">split_filename</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">molecule_name</span> <span class="o">=</span> <span class="n">split_filename</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="c1"># Read the data</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">outfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>  
            
        <span class="c1"># Loop through the data</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;RESOLUTION.&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">res_line</span> <span class="o">=</span> <span class="n">line</span>
                <span class="n">words</span> <span class="o">=</span> <span class="n">res_line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">resolution</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">datafile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">F</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">molecule_name</span><span class="si">}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">resolution</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>After you run this command, look in the directory where you ran your code and find the “resolutions.txt” file.  Open it in a text editor and look at the file.</p>
<p>In the file writing line, notice the <code class="docutils literal notranslate"><span class="pre">\n</span></code> at the end of the line.  This is the newline character.  Without it, the text in our file would just be all smushed together on one line.</p>
</section>
<section id="a-final-note-about-string-formatting">
<h2>A final note about string formatting<a class="headerlink" href="#a-final-note-about-string-formatting" title="Permalink to this headline">#</a></h2>
<p>The F’string’ notation that you can use with the print or the write command lets you format strings in many ways.  You could include other words or whole sentences.  For example, we could change the file writing line to</p>
<p><code class="docutils literal notranslate"><span class="pre">datafile.write(F'For</span> <span class="pre">the</span> <span class="pre">PDB</span> <span class="pre">ID</span> <span class="pre">{molecule_name}</span> <span class="pre">the</span> <span class="pre">resolution</span> <span class="pre">is</span> <span class="pre">{resolution}</span> <span class="pre">in</span> <span class="pre">Angstroms.')</span></code></p>
<p>where anything in the braces is a python variable and it will print the value of that variable.</p>
<div class="exercise admonition">
<p class="admonition-title">Project</p>
<p>You can complete this project to test your skills. It should be completed when this material is used in a long workshop, or if you are working through this material independently.</p>
<p>The goal of this exercise is to extract the Enzyme Commission Class for a series of enzyme structures in PDB files and write them to a text file. The files are located in the <code class="docutils literal notranslate"><span class="pre">data/PDB_files</span></code> folder. If you open any of these files in a text editor and search for the term “EC:” you will find a listing that looks like this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>COMPND   6 EC: 1.2.1.13;
</pre></div>
</div>
<p>You are probably familiar with these numbers, but just in case - the Enzyme Commission class tells you the function of an enzyme in a hierarchical format. You can learn more at the <a class="reference external" href="https://www.brenda-enzymes.org/ecexplorer.php?browser=1&amp;f%5Bnodes%5D=21&amp;f%5Baction%5D=close&amp;f%5Bchange%5D=21#21">BRENDA EC Explorer</a>.</p>
<p><strong>Your assignment</strong> is to parse the files in the <code class="docutils literal notranslate"><span class="pre">data/PDB_files</span></code> folder and write a new file named <code class="docutils literal notranslate"><span class="pre">EC_class.txt</span></code> that contains the PDB ID and EC class for each of these enzymes. When you open the file in your text editor, it should look like this:</p>
<p>7tim 	  5.3.1.1<br />
6zt7 	  3.2.1.55<br />
5eu9 	  4.2.1.11<br />
3iva 	  2.1.1.13<br />
2pkr 	  1.2.1.13<br />
3vnd 	  4.2.1.20<br />
5veu 	  1.14.14.1</p>
<div class="solution dropdown admonition">
<p class="admonition-title">Hint</p>
<p>It helps when you are writing code to break up what you have to do into steps. Overall, we want to get information from the file. How do we do that?</p>
<p>If you think about the steps you will need to do this assignment you might come up with a list that is like this:</p>
<ol class="arabic simple">
<li><p>Open the file for reading.</p></li>
<li><p>Read the data in the file.</p></li>
<li><p>Loop through the lines in the file.</p>
<ol class="arabic simple">
<li><p>Read the files to gain access to the information we want.</p></li>
<li><p>Extract the desired information and write it to a file.</p></li>
</ol>
</li>
</ol>
<p>It can be helpful when you code to write out these steps and work on it in pieces. Try to write the code using these steps. Note that as you write the code, you may come up with other steps!</p>
<p>First, think about what you have to do for step 1, and write the code for that. Next, think about how you would do step 2 and write the code for that. You can troubleshoot each step using print statments.</p>
<p>The steps build on each other, so you can work on getting each piece written before moving on to the next.</p>
</div>
<div class="solution dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span> <span class="p">(</span><span class="s1">&#39;EC_class.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">datafile</span><span class="p">:</span> <span class="c1">#This opens the file for writing</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>    <span class="c1"># Get the PDB ID</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">split_filename</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">molecule_name</span> <span class="o">=</span> <span class="n">split_filename</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># *Read the files to gain access to the information we want.*    </span>
        <span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">outfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># *Extract the desired information and write it to a file.*</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;EC:&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">ec_line</span> <span class="o">=</span> <span class="n">line</span>
                <span class="n">words1</span> <span class="o">=</span> <span class="n">ec_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>    
                <span class="c1"># print(words1)</span>
                <span class="n">words2</span> <span class="o">=</span> <span class="n">words1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                <span class="n">datafile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">F</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">molecule_name</span><span class="si">}</span><span class="s1"> </span><span class="se">\t</span><span class="s1"> </span><span class="si">{</span><span class="n">words2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Notice that the datafile.close() command is not required because this solution employs the <code class="docutils literal notranslate"><span class="pre">with</span></code> context manager.</p>
</div>
<div class="key admonition">
<p class="admonition-title">Key Points</p>
<ul class="simple">
<li><p>Use the glob function in the python library <code class="docutils literal notranslate"><span class="pre">glob</span></code> to find all the files you want to analyze.</p></li>
<li><p>You can have multiple <code class="docutils literal notranslate"><span class="pre">for</span></code> loops nested inside each other.</p></li>
<li><p>Python can only print strings to files.</p></li>
</ul>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="File_Parsing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">File Parsing</p>
      </div>
    </a>
    <a class="right-next"
       href="Working_with_Pandas.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Working with Pandas</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#processing-multiple-files">Processing multiple files</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-libraries">Importing libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-multiple-files-with-nested-for-loops">Reading multiple files with nested for loops</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#printing-to-a-file">Printing to a File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-final-note-about-string-formatting">A final note about string formatting</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Molecular Sciences Software Institute
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>